<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>matrix.matrix &mdash; SudokuStudyLib 0.5 documentation</title>
    
    <link rel="stylesheet" href="../../_static/default.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '0.5',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <link rel="top" title="SudokuStudyLib 0.5 documentation" href="../../index.html" />
    <link rel="up" title="Module code" href="../index.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li><a href="../../index.html">SudokuStudyLib 0.5 documentation</a> &raquo;</li>
          <li><a href="../index.html" accesskey="U">Module code</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <h1>Source code for matrix.matrix</h1><div class="highlight"><pre>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">.. module:: matrix</span>
<span class="sd">   :platform: Unix, Windows</span>
<span class="sd">   :synopsis: traditional method of solving sudoku</span>

<span class="sd">.. moduleauthor:: Robert J. Hwang &lt;RobertOfTaiwan@gmail.com&gt;</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">copy</span><span class="o">,</span> <span class="nn">sys</span><span class="o">,</span> <span class="nn">itertools</span><span class="o">,</span> <span class="nn">time</span><span class="o">,</span> <span class="nn">os</span>

<span class="c">#global var</span>
<span class="n">rec</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
<span class="n">records</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">done</span> <span class="o">=</span> <span class="bp">False</span>
<span class="n">error</span> <span class="o">=</span> <span class="bp">False</span>
<span class="n">HasWritenPossible</span> <span class="o">=</span> <span class="bp">False</span>
<span class="n">PrintStep</span> <span class="o">=</span> <span class="bp">True</span>


<div class="viewcode-block" id="emptyMatrix"><a class="viewcode-back" href="../../matrix.html#matrix.matrix.emptyMatrix">[docs]</a><span class="k">def</span> <span class="nf">emptyMatrix</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;init the matrix</span>
<span class="sd">    return::</span>
<span class="sd">    m: matrix map</span>
<span class="sd">    n: the number&#39;s position, the first element save the numbers</span>
<span class="sd">    p: the possible numbers in every position</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">global</span> <span class="n">rec</span><span class="p">,</span> <span class="n">records</span>
    <span class="n">rec</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
    <span class="n">records</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">m</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>  <span class="c"># By Position</span>
    <span class="n">n</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>  <span class="c"># By Number</span>
    <span class="n">p</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>  <span class="c"># Possible Number</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
        <span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)]</span>
        <span class="n">n</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)]</span>
        <span class="n">p</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)]</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">):</span>
            <span class="n">p</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">p</span>

</div>
<div class="viewcode-block" id="readDefine"><a class="viewcode-back" href="../../matrix.html#matrix.matrix.readDefine">[docs]</a><span class="k">def</span> <span class="nf">readDefine</span><span class="p">(</span><span class="nb">file</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Reading the Matrix form a define file, the format must be as x,y,v</span>
<span class="sd">    Save the file by the Unix text format</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="nb">file</span><span class="p">,</span> <span class="s">&quot;r&quot;</span><span class="p">)</span>
    <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">f</span><span class="p">:</span>
        <span class="c"># print(line)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">line</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">index</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&quot;,&quot;</span><span class="p">)</span>
            <span class="n">pos</span> <span class="o">=</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">index</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="nb">int</span><span class="p">(</span><span class="n">index</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
            <span class="n">v</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">index</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
            <span class="n">setNumber</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
            <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="n">i</span>

</div>
<div class="viewcode-block" id="setNumber"><a class="viewcode-back" href="../../matrix.html#matrix.matrix.setNumber">[docs]</a><span class="k">def</span> <span class="nf">setNumber</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">logic</span><span class="o">=</span><span class="s">&quot;defined&quot;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Setting the position x, y to be number v&quot;&quot;&quot;</span>
    <span class="k">global</span> <span class="n">records</span><span class="p">,</span> <span class="n">rec</span><span class="p">,</span> <span class="n">HasWritenPossible</span><span class="p">,</span> <span class="n">error</span><span class="p">,</span> <span class="n">PrintStep</span>

    <span class="c"># check first, if impossible, rasie the error flag</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">isPossible</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">v</span><span class="p">):</span>
        <span class="n">error</span> <span class="o">=</span> <span class="bp">True</span>
        <span class="k">return</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    
    <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">pos</span>
    <span class="n">m</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>  <span class="c"># The total assigned number in the matrix</span>
    <span class="n">m</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span>
    <span class="n">m</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="n">m</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">y</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="n">n</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>  <span class="c"># n[1..9][0] record every number(1..9)&#39;s assigned numbers</span>
    <span class="c">#print( pos, v, n[v][0])</span>
    <span class="n">n</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="n">n</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="mi">0</span><span class="p">]]</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>  <span class="c"># n[1..9][1..9] record every number(1..9)&#39;s assigned position</span>

    <span class="c">#n[0][1..9] record the box 1-9&#39;s assigned numbers</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">WhichBox</span><span class="p">(</span><span class="n">pos</span><span class="p">);</span> <span class="n">idx</span> <span class="o">=</span> <span class="p">(</span><span class="n">b</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="mi">3</span> <span class="o">+</span> <span class="n">b</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">n</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">idx</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="n">p</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span>
    <span class="k">if</span> <span class="n">logic</span> <span class="o">==</span> <span class="s">&quot;defined&quot;</span><span class="p">:</span>
        <span class="k">pass</span>
        <span class="c">#print(&quot;set {0}, {1} to be {2} by {3}&quot;.format(x, y, v, logic))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">records</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">rec</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="s">&quot;s&quot;</span><span class="p">,</span> <span class="n">logic</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">PrintStep</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s">&quot;Step#{0}: {1}, {2} to be set {3} by {4}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">records</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">logic</span><span class="p">))</span>            
    <span class="c"># same x</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">y</span> <span class="o">!=</span> <span class="n">i</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">i</span><span class="p">],</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">v</span> <span class="ow">in</span> <span class="n">p</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">i</span><span class="p">]):</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">HasWritenPossible</span><span class="p">:</span>
                <span class="n">p</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">reduceNumber</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">i</span><span class="p">),</span> <span class="n">v</span><span class="p">,</span> <span class="n">logic</span><span class="o">=</span><span class="n">logic</span><span class="p">)</span>
    <span class="c"># same y</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">x</span> <span class="o">!=</span> <span class="n">i</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">y</span><span class="p">],</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">v</span> <span class="ow">in</span> <span class="n">p</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">y</span><span class="p">]):</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">HasWritenPossible</span><span class="p">:</span>
                <span class="n">p</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">y</span><span class="p">]</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">reduceNumber</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="n">v</span><span class="p">,</span> <span class="n">logic</span><span class="o">=</span><span class="n">logic</span><span class="p">)</span>
    <span class="c"># same box</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">GetSameBoxOtherPos</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">b</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">],</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">v</span> <span class="ow">in</span> <span class="n">p</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]):</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">HasWritenPossible</span><span class="p">:</span>
                <span class="n">p</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">reduceNumber</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">),</span> <span class="n">v</span><span class="p">,</span> <span class="n">logic</span><span class="o">=</span><span class="n">logic</span><span class="p">)</span>
    <span class="k">return</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="reduceNumber"><a class="viewcode-back" href="../../matrix.html#matrix.matrix.reduceNumber">[docs]</a><span class="k">def</span> <span class="nf">reduceNumber</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">logic</span><span class="o">=</span><span class="s">&quot;defined&quot;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Reduce the possible number of the position x, y from v</span>
<span class="sd">    return: 0: Error, 1:reduce,  2:reduce and only one value left, so set the number&quot;&quot;&quot;</span>

    <span class="k">global</span> <span class="n">records</span><span class="p">,</span> <span class="n">rec</span><span class="p">,</span> <span class="n">PrintStep</span>
    <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">pos</span>

    <span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">],</span> <span class="nb">list</span><span class="p">))</span> <span class="ow">or</span> <span class="p">(</span><span class="n">v</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">p</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]):</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&quot;error: {0} not in the the pos {2} which possible set: {1}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">p</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">],</span> <span class="n">pos</span><span class="p">))</span>
        <span class="k">return</span> <span class="mi">0</span>
    
    <span class="n">p</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">logic</span> <span class="o">==</span> <span class="s">&quot;defined&quot;</span><span class="p">:</span>
        <span class="k">pass</span>
        <span class="c">#print(&quot;set {0}, {1} to be {2} by {3}&quot;.format(x, y, v, logic))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">records</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">rec</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="s">&quot;r&quot;</span><span class="p">,</span> <span class="n">logic</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">PrintStep</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s">&quot;Step#{0}: Reduce the position {1} from the value: {2} By {3}!&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">records</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">logic</span><span class="p">))</span>

    <span class="c"># if the possible value is left to be one</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">])</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">setNumber</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">p</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">logic</span><span class="p">)</span>
        <span class="k">return</span> <span class="mi">2</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">1</span>

</div>
<div class="viewcode-block" id="printMatrix"><a class="viewcode-back" href="../../matrix.html#matrix.matrix.printMatrix">[docs]</a><span class="k">def</span> <span class="nf">printMatrix</span><span class="p">(</span><span class="n">m</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;print matrix(m)&quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">):</span>
            <span class="k">print</span><span class="p">(</span><span class="s">&quot;{0:3}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span> <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="p">),</span> <span class="n">end</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&quot;&quot;</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="WhichBox"><a class="viewcode-back" href="../../matrix.html#matrix.matrix.WhichBox">[docs]</a><span class="k">def</span> <span class="nf">WhichBox</span><span class="p">(</span><span class="n">pos</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;get a Box Postion(i, j) from a position (x, y)&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="nb">int</span><span class="p">((</span><span class="n">pos</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">int</span><span class="p">((</span><span class="n">pos</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>

</div>
<div class="viewcode-block" id="GetEffectBox"><a class="viewcode-back" href="../../matrix.html#matrix.matrix.GetEffectBox">[docs]</a><span class="k">def</span> <span class="nf">GetEffectBox</span><span class="p">(</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;get Boxes Position(i, j) list from two positions which will effect these boxes&quot;&quot;&quot;</span>
    <span class="n">b1</span> <span class="o">=</span> <span class="n">WhichBox</span><span class="p">(</span><span class="n">p1</span><span class="p">)</span>
    <span class="n">b2</span> <span class="o">=</span> <span class="n">WhichBox</span><span class="p">(</span><span class="n">p2</span><span class="p">)</span>
    <span class="c"># the same x</span>
    <span class="k">if</span> <span class="n">b1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">b2</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
        <span class="n">y</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]</span>
        <span class="n">y</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">b1</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">y</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">b2</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="k">return</span> <span class="p">[(</span><span class="n">b1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">])]</span>
    <span class="c"># the same y</span>
    <span class="k">if</span> <span class="n">b1</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">b2</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
        <span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]</span>
        <span class="n">x</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">b1</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">x</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">b2</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">return</span> <span class="p">[(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">b1</span><span class="p">[</span><span class="mi">1</span><span class="p">])]</span>
    <span class="c"># x, y are all different</span>
    <span class="k">return</span> <span class="p">[(</span><span class="n">b1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">b2</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="p">(</span><span class="n">b2</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">b1</span><span class="p">[</span><span class="mi">1</span><span class="p">])]</span>

</div>
<div class="viewcode-block" id="GetEffectBoxByOne"><a class="viewcode-back" href="../../matrix.html#matrix.matrix.GetEffectBoxByOne">[docs]</a><span class="k">def</span> <span class="nf">GetEffectBoxByOne</span><span class="p">(</span><span class="n">p1</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;get Boxes Position(i, j) list by one positions which will effect these boxes&quot;&quot;&quot;</span>
    <span class="n">b1</span> <span class="o">=</span> <span class="n">WhichBox</span><span class="p">(</span><span class="n">p1</span><span class="p">)</span>
    <span class="n">box</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">):</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="o">==</span> <span class="n">b1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">or</span> <span class="n">j</span> <span class="o">==</span> <span class="n">b1</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span> <span class="o">!=</span> <span class="n">b1</span><span class="p">:</span>
                <span class="n">box</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">box</span>

</div>
<div class="viewcode-block" id="GetEffectBoxByOneDir"><a class="viewcode-back" href="../../matrix.html#matrix.matrix.GetEffectBoxByOneDir">[docs]</a><span class="k">def</span> <span class="nf">GetEffectBoxByOneDir</span><span class="p">(</span><span class="n">grp</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;get Boxes Position(i, j) list by one group which will effect these boxes&quot;&quot;&quot;</span>
    <span class="n">b1</span> <span class="o">=</span> <span class="n">WhichBox</span><span class="p">(</span><span class="n">grp</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>  <span class="c"># use the first possible position to get box id</span>
    <span class="n">box</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">):</span>
        <span class="c"># the same x</span>
        <span class="k">if</span> <span class="n">grp</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">i</span> <span class="o">!=</span> <span class="n">b1</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
            <span class="n">box</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">b1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">i</span><span class="p">))</span>
        <span class="c"># the same y</span>
        <span class="k">if</span> <span class="n">grp</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">i</span> <span class="o">!=</span> <span class="n">b1</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
            <span class="n">box</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">i</span><span class="p">,</span> <span class="n">b1</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
    <span class="k">return</span> <span class="n">box</span>

</div>
<div class="viewcode-block" id="GetEffectBoxByOnePosAndOneDir"><a class="viewcode-back" href="../../matrix.html#matrix.matrix.GetEffectBoxByOnePosAndOneDir">[docs]</a><span class="k">def</span> <span class="nf">GetEffectBoxByOnePosAndOneDir</span><span class="p">(</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">,</span> <span class="n">grp</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;get Boxes Position(i, j) list from one position and one group which will effect these boxes</span>
<span class="sd">    but only get same x or same y box</span>
<span class="sd">    grp: (x,0)|((0,y)&quot;&quot;&quot;</span>

    <span class="n">b1</span> <span class="o">=</span> <span class="n">WhichBox</span><span class="p">(</span><span class="n">p1</span><span class="p">)</span>
    <span class="n">b2</span> <span class="o">=</span> <span class="n">WhichBox</span><span class="p">(</span><span class="n">p2</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">b1</span> <span class="o">==</span> <span class="n">b2</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">[]</span>
    <span class="n">rtn</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="c"># the same x</span>
    <span class="k">if</span> <span class="n">grp</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">b1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">b2</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
        <span class="n">y</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]</span>
        <span class="n">y</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">b1</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">y</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">b2</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">rtn</span> <span class="o">=</span> <span class="p">[(</span><span class="n">b1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">])]</span>
    <span class="c"># the same y</span>
    <span class="k">elif</span> <span class="n">grp</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">b1</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">b2</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
        <span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]</span>
        <span class="n">x</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">b1</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">x</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">b2</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">rtn</span> <span class="o">=</span> <span class="p">[(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">b1</span><span class="p">[</span><span class="mi">1</span><span class="p">])]</span>
    <span class="c"># x, y are all different</span>
    <span class="k">elif</span> <span class="n">b1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="n">b2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">and</span> <span class="n">b1</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="n">b2</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
        <span class="n">rtn</span> <span class="o">=</span> <span class="p">[(</span><span class="n">b1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">b2</span><span class="p">[</span><span class="mi">1</span><span class="p">])]</span> <span class="k">if</span> <span class="n">grp</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span> <span class="k">else</span> <span class="p">[(</span><span class="n">b2</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">b1</span><span class="p">[</span><span class="mi">1</span><span class="p">])]</span>

    <span class="k">return</span> <span class="n">rtn</span>

</div>
<div class="viewcode-block" id="GetEffectBoxByTwoGrp"><a class="viewcode-back" href="../../matrix.html#matrix.matrix.GetEffectBoxByTwoGrp">[docs]</a><span class="k">def</span> <span class="nf">GetEffectBoxByTwoGrp</span><span class="p">(</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">,</span> <span class="n">d1</span><span class="p">,</span> <span class="n">d2</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;get Boxes Position(i, j) list by two directed group which will effect these boxes</span>
<span class="sd">    p1, p2: any position of those groups to make sure the whichbox</span>
<span class="sd">    d1, d2: format like (x,0) or (0, y) to say the group&#39;s direction&quot;&quot;&quot;</span>

    <span class="n">b1</span> <span class="o">=</span> <span class="n">WhichBox</span><span class="p">(</span><span class="n">p1</span><span class="p">)</span>
    <span class="n">b2</span> <span class="o">=</span> <span class="n">WhichBox</span><span class="p">(</span><span class="n">p2</span><span class="p">)</span>
    <span class="n">rtn</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="c">#print(p1, p2, d1, d2, b1, b2)</span>
    <span class="k">if</span> <span class="n">b1</span> <span class="o">==</span> <span class="n">b2</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">rtn</span>
    <span class="c"># the same x</span>
    <span class="k">if</span> <span class="n">d1</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">d2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">b1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">b2</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
        <span class="n">y</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
        <span class="n">y</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">b1</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">y</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">b2</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">rtn</span> <span class="o">=</span> <span class="p">[(</span><span class="n">b1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">])]</span>
    <span class="c"># the same y</span>
    <span class="k">elif</span> <span class="n">d1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">d2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">b1</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">b2</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
        <span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
        <span class="n">x</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">b1</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">x</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">b2</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">rtn</span> <span class="o">=</span> <span class="p">[(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">b1</span><span class="p">[</span><span class="mi">1</span><span class="p">])]</span>
    <span class="c"># d1 and d2 are different direction x, y are all different</span>
    <span class="k">elif</span> <span class="n">d1</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="n">d2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="ow">and</span> <span class="n">d1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="n">d2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">and</span> <span class="n">b1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="n">b2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">and</span> <span class="n">b1</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="n">b2</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
        <span class="n">rtn</span> <span class="o">=</span> <span class="p">[(</span><span class="n">b1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">b2</span><span class="p">[</span><span class="mi">1</span><span class="p">])]</span> <span class="k">if</span> <span class="n">d1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">!=</span><span class="mi">0</span> <span class="k">else</span> <span class="p">[(</span><span class="n">b2</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">b1</span><span class="p">[</span><span class="mi">1</span><span class="p">])]</span>
        
    <span class="k">return</span> <span class="n">rtn</span>

</div>
<div class="viewcode-block" id="isInBox"><a class="viewcode-back" href="../../matrix.html#matrix.matrix.isInBox">[docs]</a><span class="k">def</span> <span class="nf">isInBox</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">number</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Check the number is filled in a box (i, j)&quot;&quot;&quot;</span>

    <span class="n">Pos</span> <span class="o">=</span> <span class="n">GetAllPosInBox</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">Pos</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">m</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]</span> <span class="o">==</span> <span class="n">number</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">True</span>
    <span class="k">return</span> <span class="bp">False</span>

</div>
<div class="viewcode-block" id="GetAllPosInBox"><a class="viewcode-back" href="../../matrix.html#matrix.matrix.GetAllPosInBox">[docs]</a><span class="k">def</span> <span class="nf">GetAllPosInBox</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s">&quot;a&quot;</span><span class="p">,</span> <span class="n">num</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">diff</span><span class="o">=</span><span class="p">[]):</span>
    <span class="sd">&quot;&quot;&quot;Getting a box&#39;s all position</span>
<span class="sd">    method: a: all, s: all assigned, u: all un-assigned</span>
<span class="sd">    num: 0(1-9), if method=&quot;u&quot;, if the num is 1-9, it will only take the positions that is possible be filled by the num</span>
<span class="sd">    diff: the posithon in diff must be excluded&quot;&quot;&quot;</span>

    <span class="n">Pos</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
    <span class="n">checkdiff</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">diff</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">):</span>
            <span class="n">nX</span> <span class="o">=</span> <span class="p">(</span><span class="n">b</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">3</span> <span class="o">+</span> <span class="n">i</span>
            <span class="n">nY</span> <span class="o">=</span> <span class="p">(</span><span class="n">b</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">3</span> <span class="o">+</span> <span class="n">j</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">method</span> <span class="o">==</span> <span class="s">&quot;s&quot;</span> <span class="ow">and</span> <span class="n">m</span><span class="p">[</span><span class="n">nX</span><span class="p">][</span><span class="n">nY</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">method</span> <span class="o">==</span> <span class="s">&quot;u&quot;</span> <span class="ow">and</span> <span class="n">m</span><span class="p">[</span><span class="n">nX</span><span class="p">][</span><span class="n">nY</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">):</span>
                <span class="k">continue</span>
            <span class="k">if</span> <span class="n">num</span><span class="o">!=</span><span class="mi">0</span> <span class="ow">and</span> <span class="n">method</span> <span class="o">==</span> <span class="s">&quot;u&quot;</span> <span class="ow">and</span> <span class="p">(</span><span class="n">num</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">p</span><span class="p">[</span><span class="n">nX</span><span class="p">][</span><span class="n">nY</span><span class="p">]):</span>
                <span class="k">continue</span>
            <span class="k">if</span> <span class="n">checkdiff</span> <span class="ow">and</span> <span class="p">(</span><span class="n">nX</span><span class="p">,</span> <span class="n">nY</span><span class="p">)</span> <span class="ow">in</span> <span class="n">diff</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="n">Pos</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">nX</span><span class="p">,</span> <span class="n">nY</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">Pos</span>

</div>
<div class="viewcode-block" id="GetSameBoxOtherPos"><a class="viewcode-back" href="../../matrix.html#matrix.matrix.GetSameBoxOtherPos">[docs]</a><span class="k">def</span> <span class="nf">GetSameBoxOtherPos</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">pos</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;get the other postions in a box which there is a postion of x, y&quot;&quot;&quot;</span>

    <span class="n">b</span> <span class="o">=</span> <span class="n">GetAllPosInBox</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">WhichBox</span><span class="p">(</span><span class="n">pos</span><span class="p">))</span>
    <span class="n">b</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">b</span>

</div>
<div class="viewcode-block" id="GetCanNotSeenInBox"><a class="viewcode-back" href="../../matrix.html#matrix.matrix.GetCanNotSeenInBox">[docs]</a><span class="k">def</span> <span class="nf">GetCanNotSeenInBox</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;get the postions in a box(b) which can not be seen in position p1 and p2 which are in the same box</span>
<span class="sd">    and those positions are not filled</span>
<span class="sd">    p1, p2 must be in different x and y, p1, p2 sometime as the form (x,0)|(0,y)&quot;&quot;&quot;</span>

    <span class="n">Pos</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">):</span>
            <span class="n">x</span> <span class="o">=</span> <span class="p">(</span><span class="n">b</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">3</span> <span class="o">+</span> <span class="n">i</span>
            <span class="n">y</span> <span class="o">=</span> <span class="p">(</span><span class="n">b</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">3</span> <span class="o">+</span> <span class="n">j</span>
            <span class="k">if</span> <span class="n">x</span> <span class="o">==</span> <span class="n">p1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">or</span> <span class="n">x</span> <span class="o">==</span> <span class="n">p2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">or</span> <span class="n">y</span> <span class="o">==</span> <span class="n">p1</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="ow">or</span> <span class="n">y</span> <span class="o">==</span> <span class="n">p2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="ow">or</span> <span class="n">m</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]</span><span class="o">!=</span><span class="mi">0</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="n">Pos</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">Pos</span>

</div>
<div class="viewcode-block" id="isDone"><a class="viewcode-back" href="../../matrix.html#matrix.matrix.isDone">[docs]</a><span class="k">def</span> <span class="nf">isDone</span><span class="p">(</span><span class="n">m</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Checking the Matrix is done or not</span>

<span class="sd">    .. note: only Check the vertical amount is 9</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">flag</span> <span class="o">=</span> <span class="bp">True</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">m</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">9</span><span class="p">:</span>
            <span class="n">flag</span> <span class="o">=</span> <span class="bp">False</span>
            <span class="k">break</span><span class="p">;</span>
    <span class="k">return</span> <span class="n">flag</span>

</div>
<div class="viewcode-block" id="isPossible"><a class="viewcode-back" href="../../matrix.html#matrix.matrix.isPossible">[docs]</a><span class="k">def</span> <span class="nf">isPossible</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">groups</span><span class="o">=</span><span class="p">[]):</span>
    <span class="sd">&quot;&quot;&quot;Check if the value v is possible at pos(x, y)&quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">isPossibleByX</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">groups</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">False</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">isPossibleByY</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">groups</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">False</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">isPossibleByBox</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">v</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">False</span>
    
    <span class="k">return</span> <span class="bp">True</span>

</div>
<div class="viewcode-block" id="isPossibleByX"><a class="viewcode-back" href="../../matrix.html#matrix.matrix.isPossibleByX">[docs]</a><span class="k">def</span> <span class="nf">isPossibleByX</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">groups</span><span class="o">=</span><span class="p">[]):</span>
    <span class="sd">&quot;&quot;&quot;Check the same x if the value v is possible at pos(x, y)&quot;&quot;&quot;</span>

    <span class="c"># check the same x</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">pos</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="n">i</span> <span class="ow">and</span> <span class="n">m</span><span class="p">[</span><span class="n">pos</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="n">v</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">False</span>
    <span class="c"># check the group number</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">groups</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">b</span> <span class="o">=</span> <span class="n">WhichBox</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">grp</span> <span class="ow">in</span> <span class="n">groups</span><span class="p">:</span>
            <span class="c"># if in same box or the group is the same y, just ignore</span>
            <span class="k">if</span> <span class="n">b</span> <span class="o">==</span> <span class="n">WhichBox</span><span class="p">(</span><span class="n">grp</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span> <span class="ow">or</span> <span class="n">grp</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">pos</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">grp</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]:</span>
                    <span class="k">return</span> <span class="bp">False</span>        
    <span class="k">return</span> <span class="bp">True</span>

</div>
<div class="viewcode-block" id="isPossibleByY"><a class="viewcode-back" href="../../matrix.html#matrix.matrix.isPossibleByY">[docs]</a><span class="k">def</span> <span class="nf">isPossibleByY</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">groups</span><span class="o">=</span><span class="p">[]):</span>
    <span class="sd">&quot;&quot;&quot;Check the same y if the value v is possible at pos(x, y)</span>
<span class="sd">    if group number has passed, should check box group number&quot;&quot;&quot;</span>

    <span class="c"># check the same y</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">pos</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="n">i</span> <span class="ow">and</span> <span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">pos</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="o">==</span> <span class="n">v</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">False</span>
    <span class="c"># check the group number</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">groups</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">b</span> <span class="o">=</span> <span class="n">WhichBox</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">grp</span> <span class="ow">in</span> <span class="n">groups</span><span class="p">:</span>
            <span class="c"># if in same box or the group is the same x, just ignore</span>
            <span class="k">if</span> <span class="n">b</span> <span class="o">==</span> <span class="n">WhichBox</span><span class="p">(</span><span class="n">grp</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span> <span class="ow">or</span> <span class="n">grp</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">pos</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">grp</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]:</span>
                    <span class="k">return</span> <span class="bp">False</span>                   
    <span class="k">return</span> <span class="bp">True</span>

</div>
<div class="viewcode-block" id="isPossibleByBox"><a class="viewcode-back" href="../../matrix.html#matrix.matrix.isPossibleByBox">[docs]</a><span class="k">def</span> <span class="nf">isPossibleByBox</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">groups</span><span class="o">=</span><span class="p">[]):</span>
    <span class="sd">&quot;&quot;&quot;Check the same box if the value v is possible at pos(x, y)&quot;&quot;&quot;</span>

    <span class="c"># same box</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">GetSameBoxOtherPos</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">pos</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">b</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">==</span> <span class="n">v</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">False</span>
    <span class="k">return</span> <span class="bp">True</span>

</div>
<div class="viewcode-block" id="CheckObvious"><a class="viewcode-back" href="../../matrix.html#matrix.matrix.CheckObvious">[docs]</a><span class="k">def</span> <span class="nf">CheckObvious</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">amt</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Checking the every number in every two different position can descide</span>
<span class="sd">    the number in other box which does not have the number yet&quot;&quot;&quot;</span>

    <span class="c">#print(&quot;Step #1: CheckObvious: {0}&quot;.format(amt))</span>
    <span class="k">for</span> <span class="n">number</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">n</span><span class="p">[</span><span class="n">number</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">n</span><span class="p">[</span><span class="n">number</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;=</span><span class="mi">9</span> <span class="p">:</span>
            <span class="k">continue</span>
        <span class="n">nums</span> <span class="o">=</span> <span class="n">n</span><span class="p">[</span><span class="n">number</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">nums</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">nums</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="n">j</span><span class="p">:</span>
                    <span class="k">break</span>  <span class="c"># same pos</span>
                <span class="n">effectBox</span> <span class="o">=</span> <span class="n">GetEffectBox</span><span class="p">(</span><span class="n">n</span><span class="p">[</span><span class="n">number</span><span class="p">][</span><span class="n">i</span><span class="p">],</span> <span class="n">n</span><span class="p">[</span><span class="n">number</span><span class="p">][</span><span class="n">j</span><span class="p">])</span>
                <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">effectBox</span><span class="p">:</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="n">isInBox</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">number</span><span class="p">):</span>
                        <span class="n">possiblePos</span> <span class="o">=</span> <span class="n">GetCanNotSeenInBox</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">n</span><span class="p">[</span><span class="n">number</span><span class="p">][</span><span class="n">i</span><span class="p">],</span> <span class="n">n</span><span class="p">[</span><span class="n">number</span><span class="p">][</span><span class="n">j</span><span class="p">])</span>
                        <span class="c">#print(number, n[number][i], n[number][j], possiblePos, b)</span>
                        <span class="n">pos2</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">possiblePos</span><span class="p">)</span>
                        <span class="k">for</span> <span class="n">pos</span> <span class="ow">in</span> <span class="n">pos2</span><span class="p">:</span>
                            <span class="k">if</span> <span class="ow">not</span> <span class="n">isPossibleByX</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">number</span><span class="p">)</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">isPossibleByY</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">number</span><span class="p">):</span>
                                <span class="n">possiblePos</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span>
                        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">possiblePos</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                            <span class="c"># if only one possible pos means it is the position of the number</span>
                            <span class="c"># and it will use the same function to continue find another possible position for the number</span>
                            <span class="n">amt</span> <span class="o">+=</span> <span class="mi">1</span>
                            <span class="n">setNumber</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">possiblePos</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">number</span><span class="p">,</span> <span class="n">logic</span><span class="o">=</span><span class="s">&quot;Obvious for {0}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">number</span><span class="p">))</span>
                            <span class="c"># recall self: CheckObvious()</span>
                            <span class="n">amt</span> <span class="o">=</span> <span class="n">CheckObvious</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">amt</span><span class="o">=</span><span class="n">amt</span><span class="p">)</span>
                            <span class="k">return</span> <span class="n">amt</span>  <span class="c"># Because it has launched another CheckObvious(), so it can be stopped here</span>

    <span class="k">return</span> <span class="n">amt</span>

</div>
<div class="viewcode-block" id="CheckObviousByOne"><a class="viewcode-back" href="../../matrix.html#matrix.matrix.CheckObviousByOne">[docs]</a><span class="k">def</span> <span class="nf">CheckObviousByOne</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">amt</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Checking every number with only one assigned numer or a group number to decide</span>
<span class="sd">    the number in other box which does not have the number yet&quot;&quot;&quot;</span>

    <span class="c">#print(&quot;Step #1: CheckObviousByOne: {0}&quot;.format(amt))</span>
    <span class="k">for</span> <span class="n">number</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">n</span><span class="p">[</span><span class="n">number</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">n</span><span class="p">[</span><span class="n">number</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;=</span><span class="mi">9</span> <span class="p">:</span>
            <span class="k">continue</span>
        <span class="c"># Check every assigned position</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">[</span><span class="n">number</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
            <span class="n">effectBox</span> <span class="o">=</span> <span class="n">GetEffectBoxByOne</span><span class="p">(</span><span class="n">n</span><span class="p">[</span><span class="n">number</span><span class="p">][</span><span class="n">i</span><span class="p">])</span>
            <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">effectBox</span><span class="p">:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">isInBox</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">number</span><span class="p">):</span>
                    <span class="n">possiblePos</span> <span class="o">=</span> <span class="n">GetCanNotSeenInBox</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">n</span><span class="p">[</span><span class="n">number</span><span class="p">][</span><span class="n">i</span><span class="p">],</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
                    <span class="c">#print(number, n[number][i], n[number][j], possiblePos, b)</span>
                    <span class="n">pos2</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">possiblePos</span><span class="p">)</span>
                    <span class="k">for</span> <span class="n">pos</span> <span class="ow">in</span> <span class="n">pos2</span><span class="p">:</span>
                        <span class="k">if</span> <span class="ow">not</span> <span class="n">isPossibleByX</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">number</span><span class="p">)</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">isPossibleByY</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">number</span><span class="p">):</span>
                            <span class="n">possiblePos</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span>
                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">possiblePos</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                        <span class="c"># if only one possible pos means it is the position of the number</span>
                        <span class="c"># and it will use the same function to continue find another possible position for the number</span>
                        <span class="n">amt</span> <span class="o">+=</span> <span class="mi">1</span>
                        <span class="n">setNumber</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">possiblePos</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">number</span><span class="p">,</span> <span class="n">logic</span><span class="o">=</span><span class="s">&quot;ObviousByOne for {0}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">number</span><span class="p">))</span>
                        <span class="c"># recall self: CheckObvious()</span>
                        <span class="n">amt</span> <span class="o">=</span> <span class="n">CheckObviousByOne</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">amt</span><span class="o">=</span><span class="n">amt</span><span class="p">)</span>
                        <span class="k">return</span> <span class="n">amt</span> <span class="c"># Because it has launched another CheckObvious(), so it can be stopped here                </span>
    <span class="k">return</span> <span class="n">amt</span>

</div>
<div class="viewcode-block" id="GetGroupInBox"><a class="viewcode-back" href="../../matrix.html#matrix.matrix.GetGroupInBox">[docs]</a><span class="k">def</span> <span class="nf">GetGroupInBox</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">number</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Get the number Groups which are formed natually in a box</span>
<span class="sd">    because the remain possible positions can at the same line&quot;&quot;&quot;</span>

    <span class="n">groups</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
    <span class="n">amt</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">):</span>
            <span class="n">Pos</span> <span class="o">=</span> <span class="n">GetAllPosInBox</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">),</span> <span class="n">method</span><span class="o">=</span><span class="s">&quot;u&quot;</span><span class="p">,</span> <span class="n">num</span><span class="o">=</span><span class="n">number</span><span class="p">)</span>
            <span class="n">possible</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">Pos</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">possible</span> <span class="o">!=</span> <span class="mi">2</span> <span class="ow">and</span> <span class="n">possible</span> <span class="o">!=</span> <span class="mi">3</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="n">g</span> <span class="o">=</span> <span class="n">GetIndirectNumberInBox</span><span class="p">(</span><span class="n">Pos</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">g</span> <span class="o">!=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">):</span>
                <span class="n">amt</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="n">groups</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">g</span><span class="p">,</span> <span class="n">Pos</span><span class="p">))</span>

    <span class="n">sets</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c"># the amount of set Number</span>
    <span class="n">reduces</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c"># the amount of reduce Number</span>
    <span class="k">for</span> <span class="n">grp</span> <span class="ow">in</span> <span class="n">groups</span><span class="p">:</span>
        <span class="c"># the same x</span>
        <span class="k">if</span> <span class="n">grp</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">Pos</span> <span class="o">=</span> <span class="n">GetAllPosOfX</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">grp</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">diff</span><span class="o">=</span><span class="n">grp</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">method</span><span class="o">=</span><span class="s">&quot;u&quot;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">p1</span> <span class="ow">in</span> <span class="n">Pos</span><span class="p">:</span>
                <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">p1</span>
                <span class="k">if</span> <span class="n">m</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">number</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">p</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]:</span>
                    <span class="k">continue</span>
                <span class="n">rtn</span> <span class="o">=</span> <span class="n">reduceNumber</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">p1</span><span class="p">,</span> <span class="n">number</span><span class="p">,</span> <span class="n">logic</span><span class="o">=</span><span class="s">&quot;ByBoxGroup&quot;</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">rtn</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                    <span class="n">sets</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="k">elif</span> <span class="n">rtn</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">reduces</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="c"># the same y</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">Pos</span> <span class="o">=</span> <span class="n">GetAllPosOfY</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">grp</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">diff</span><span class="o">=</span><span class="n">grp</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">method</span><span class="o">=</span><span class="s">&quot;u&quot;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">p1</span> <span class="ow">in</span> <span class="n">Pos</span><span class="p">:</span>
                <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">p1</span>
                <span class="k">if</span> <span class="n">m</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]</span><span class="o">!=</span><span class="mi">0</span> <span class="ow">or</span> <span class="n">number</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">p</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]:</span>
                    <span class="k">continue</span>
                <span class="n">rtn</span> <span class="o">=</span> <span class="n">reduceNumber</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">p1</span><span class="p">,</span> <span class="n">number</span><span class="p">,</span> <span class="n">logic</span><span class="o">=</span><span class="s">&quot;ByBoxGroup&quot;</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">rtn</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                    <span class="n">sets</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="k">elif</span> <span class="n">rtn</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">reduces</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="c"># if some group number effect something, recall self to check again</span>
    <span class="k">if</span> <span class="n">reduces</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">sets</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">GetGroupInBox</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">number</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">groups</span>

</div>
<div class="viewcode-block" id="GetAllPosOfX"><a class="viewcode-back" href="../../matrix.html#matrix.matrix.GetAllPosOfX">[docs]</a><span class="k">def</span> <span class="nf">GetAllPosOfX</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">idx</span><span class="p">,</span> <span class="n">diff</span><span class="o">=</span><span class="p">[],</span> <span class="n">method</span><span class="o">=</span><span class="s">&quot;a&quot;</span><span class="p">,</span> <span class="n">num</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Get all other possition of line from x = idx than those in diff</span>
<span class="sd">    method: a: all, s:has assigned, u:not assigned</span>
<span class="sd">    num: if method is u and set the number to 1-9, will get all possible pos which are possible to be assigned the num&quot;&quot;&quot;</span>

    <span class="n">Pos</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
    <span class="n">k</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">lGetOtherThan</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">diff</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">):</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">method</span><span class="o">==</span><span class="s">&quot;u&quot;</span> <span class="ow">and</span> <span class="n">m</span><span class="p">[</span><span class="n">idx</span><span class="p">][</span><span class="n">i</span><span class="p">]</span><span class="o">!=</span><span class="mi">0</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">method</span><span class="o">==</span><span class="s">&quot;s&quot;</span> <span class="ow">and</span> <span class="n">m</span><span class="p">[</span><span class="n">idx</span><span class="p">][</span><span class="n">i</span><span class="p">]</span><span class="o">==</span><span class="mi">0</span><span class="p">):</span>
            <span class="k">continue</span>
        <span class="k">if</span> <span class="n">lGetOtherThan</span> <span class="ow">and</span> <span class="p">(</span><span class="n">idx</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span> <span class="ow">in</span> <span class="n">diff</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="k">if</span> <span class="n">num</span><span class="o">!=</span><span class="mi">0</span> <span class="ow">and</span> <span class="n">method</span><span class="o">==</span><span class="s">&quot;u&quot;</span> <span class="ow">and</span> <span class="n">num</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">p</span><span class="p">[</span><span class="n">idx</span><span class="p">][</span><span class="n">i</span><span class="p">]:</span>
            <span class="k">continue</span>
        <span class="n">k</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">Pos</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">idx</span><span class="p">,</span> <span class="n">i</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">Pos</span>

</div>
<div class="viewcode-block" id="GetAllPosOfY"><a class="viewcode-back" href="../../matrix.html#matrix.matrix.GetAllPosOfY">[docs]</a><span class="k">def</span> <span class="nf">GetAllPosOfY</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">idx</span><span class="p">,</span> <span class="n">diff</span><span class="o">=</span><span class="p">[],</span> <span class="n">method</span><span class="o">=</span><span class="s">&quot;a&quot;</span><span class="p">,</span> <span class="n">num</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Get all other possition of line from y = idx than those in diff</span>
<span class="sd">    method: a: all, s:has assigned, u:not assigned</span>
<span class="sd">    num: if method is u and set the number to 1-9, will get all possible pos which are possible to be assigned the num&quot;&quot;&quot;</span>

    <span class="n">Pos</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
    <span class="n">k</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">lGetOtherThan</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">diff</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">):</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">method</span> <span class="o">==</span> <span class="s">&quot;u&quot;</span> <span class="ow">and</span> <span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">idx</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">method</span> <span class="o">==</span> <span class="s">&quot;s&quot;</span> <span class="ow">and</span> <span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">idx</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">):</span>
            <span class="k">continue</span>
        <span class="k">if</span> <span class="n">lGetOtherThan</span> <span class="ow">and</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">idx</span><span class="p">)</span> <span class="ow">in</span> <span class="n">diff</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="k">if</span> <span class="n">num</span> <span class="o">!=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">method</span> <span class="o">==</span> <span class="s">&quot;u&quot;</span> <span class="ow">and</span> <span class="n">num</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">p</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">idx</span><span class="p">]:</span>
            <span class="k">continue</span>
        <span class="n">k</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">Pos</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">i</span><span class="p">,</span> <span class="n">idx</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">Pos</span>

</div>
<div class="viewcode-block" id="ReduceByBoxGroup"><a class="viewcode-back" href="../../matrix.html#matrix.matrix.ReduceByBoxGroup">[docs]</a><span class="k">def</span> <span class="nf">ReduceByBoxGroup</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Reduce Method #1: Reduce by the group number in a box&quot;&quot;&quot;</span>

    <span class="n">sets</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c"># the amount of set Number</span>
    <span class="n">reduces</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c"># the amount of reduce Number</span>
    <span class="k">for</span> <span class="n">num</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">):</span>
        <span class="n">groups</span> <span class="o">=</span> <span class="n">GetGroupInBox</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">num</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">grp</span> <span class="ow">in</span> <span class="n">groups</span><span class="p">:</span>
            <span class="c"># the same x</span>
            <span class="k">if</span> <span class="n">grp</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">Pos</span> <span class="o">=</span> <span class="n">GetAllPosOfX</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">grp</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">diff</span><span class="o">=</span><span class="n">grp</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">method</span><span class="o">=</span><span class="s">&quot;u&quot;</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">p1</span> <span class="ow">in</span> <span class="n">Pos</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">num</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">p</span><span class="p">[</span><span class="n">p1</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="n">p1</span><span class="p">[</span><span class="mi">1</span><span class="p">]]:</span>
                        <span class="k">continue</span>
                    <span class="n">rtn</span> <span class="o">=</span> <span class="n">reduceNumber</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">p1</span><span class="p">,</span> <span class="n">num</span><span class="p">,</span> <span class="n">logic</span><span class="o">=</span><span class="s">&quot;ByBoxGroup&quot;</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">rtn</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                        <span class="n">sets</span> <span class="o">+=</span> <span class="mi">1</span>
                    <span class="k">elif</span> <span class="n">rtn</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                        <span class="n">reduces</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="c"># the same y</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">Pos</span> <span class="o">=</span> <span class="n">GetAllPosOfY</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">grp</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">diff</span><span class="o">=</span><span class="n">grp</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">method</span><span class="o">=</span><span class="s">&quot;u&quot;</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">p1</span> <span class="ow">in</span> <span class="n">Pos</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">num</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">p</span><span class="p">[</span><span class="n">p1</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="n">p1</span><span class="p">[</span><span class="mi">1</span><span class="p">]]:</span>
                        <span class="k">continue</span>
                    <span class="n">rtn</span> <span class="o">=</span> <span class="n">reduceNumber</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">p1</span><span class="p">,</span> <span class="n">num</span><span class="p">,</span> <span class="n">logic</span><span class="o">=</span><span class="s">&quot;ByBoxGroup&quot;</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">rtn</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                        <span class="n">sets</span> <span class="o">+=</span> <span class="mi">1</span>
                    <span class="k">elif</span> <span class="n">rtn</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                        <span class="n">reduces</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="n">reduces</span><span class="p">,</span> <span class="n">sets</span>
                
</div>
<div class="viewcode-block" id="CheckInObvious"><a class="viewcode-back" href="../../matrix.html#matrix.matrix.CheckInObvious">[docs]</a><span class="k">def</span> <span class="nf">CheckInObvious</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">amt</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Checking the number in every two different position can decide</span>
<span class="sd">    the number in other box which does not have the number yet</span>
<span class="sd">    Parameters:</span>
<span class="sd">    groups: [((x,0)|(0,y), [(x1,y1),(x2,y2)...]),...]</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c">#print(&quot;Step #2: CheckInObvious!&quot;)</span>
    
    <span class="k">for</span> <span class="n">number</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">):</span>

        <span class="c"># if the number is done</span>
        <span class="k">if</span> <span class="n">n</span><span class="p">[</span><span class="n">number</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">n</span><span class="p">[</span><span class="n">number</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;=</span><span class="mi">9</span> <span class="p">:</span>
            <span class="k">continue</span> 
        
        <span class="c"># at first, add natual number groups into groups</span>
        <span class="n">groups</span> <span class="o">=</span> <span class="n">GetGroupInBox</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">number</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">groups</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">continue</span>

        <span class="c"># check every single group number</span>
        <span class="k">for</span> <span class="n">grp</span> <span class="ow">in</span> <span class="n">groups</span><span class="p">:</span>
            <span class="c">#print( grp )</span>
            <span class="n">effectBox</span> <span class="o">=</span> <span class="n">GetEffectBoxByOneDir</span><span class="p">(</span><span class="n">grp</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">effectBox</span><span class="p">:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">isInBox</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">number</span><span class="p">):</span>
                    <span class="n">possiblePos</span> <span class="o">=</span> <span class="n">GetCanNotSeenInBox</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">grp</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
                    <span class="c">#print(number, n[number][i], n[number][j], possiblePos, b)</span>
                    <span class="n">pos2</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">possiblePos</span><span class="p">)</span>
                    <span class="k">for</span> <span class="n">pos</span> <span class="ow">in</span> <span class="n">pos2</span><span class="p">:</span>
                        <span class="k">if</span> <span class="ow">not</span> <span class="n">isPossibleByX</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">number</span><span class="p">,</span> <span class="n">groups</span><span class="o">=</span><span class="n">groups</span><span class="p">)</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">isPossibleByY</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">number</span><span class="p">,</span> <span class="n">groups</span><span class="o">=</span><span class="n">groups</span><span class="p">):</span>
                            <span class="n">possiblePos</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span>
                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">possiblePos</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                        <span class="c"># if only one possible pos means it is the position of the number</span>
                        <span class="c"># and it will use the same function to continue find another possible position for the number</span>
                        <span class="n">amt</span> <span class="o">+=</span> <span class="mi">1</span>
                        <span class="n">setNumber</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">possiblePos</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">number</span><span class="p">,</span> <span class="n">logic</span><span class="o">=</span><span class="s">&quot;InObviousByOne for {0}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">number</span><span class="p">))</span>
            
        <span class="c"># check groups and have assigned position</span>
        <span class="k">for</span> <span class="n">grp</span> <span class="ow">in</span> <span class="n">groups</span><span class="p">:</span>
            <span class="n">nums</span> <span class="o">=</span> <span class="n">n</span><span class="p">[</span><span class="n">number</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">nums</span><span class="p">):</span>
                <span class="n">effectBox</span> <span class="o">=</span> <span class="n">GetEffectBoxByOnePosAndOneDir</span><span class="p">(</span><span class="n">n</span><span class="p">[</span><span class="n">number</span><span class="p">][</span><span class="n">j</span><span class="p">],</span> <span class="n">grp</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">grp</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">effectBox</span><span class="p">:</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="n">isInBox</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">number</span><span class="p">):</span>
                        <span class="n">possiblePos</span> <span class="o">=</span> <span class="n">GetCanNotSeenInBox</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">grp</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">n</span><span class="p">[</span><span class="n">number</span><span class="p">][</span><span class="n">j</span><span class="p">])</span>
                        <span class="n">pos2</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">possiblePos</span><span class="p">)</span>
                        <span class="k">for</span> <span class="n">pos</span> <span class="ow">in</span> <span class="n">pos2</span><span class="p">:</span>
                            <span class="k">if</span> <span class="ow">not</span> <span class="n">isPossibleByX</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">number</span><span class="p">,</span> <span class="n">groups</span><span class="o">=</span><span class="n">groups</span><span class="p">)</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">isPossibleByY</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">number</span><span class="p">,</span> <span class="n">groups</span><span class="o">=</span><span class="n">groups</span><span class="p">):</span>
                                <span class="n">possiblePos</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span>
                        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">possiblePos</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                            <span class="c"># if only one possible pos means it is the position of the number</span>
                            <span class="c"># and it will use the same function to continue find another possible position for the number</span>
                            <span class="n">amt</span> <span class="o">=</span> <span class="n">amt</span> <span class="o">+</span> <span class="mi">1</span>
                            <span class="c"># print(number, groups, n[number][j], b)</span>
                            <span class="n">setNumber</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">possiblePos</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">number</span><span class="p">,</span> <span class="n">logic</span><span class="o">=</span><span class="s">&quot;InObviousWithGroup for {0}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">number</span><span class="p">))</span>
                        
        <span class="c"># if there is only one group, just return</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">groups</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">amt</span>

        <span class="c"># check two groups:</span>
        <span class="k">for</span> <span class="n">g1</span> <span class="ow">in</span> <span class="n">groups</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">g2</span> <span class="ow">in</span> <span class="n">groups</span><span class="p">:</span>
                <span class="n">effectBox</span> <span class="o">=</span> <span class="n">GetEffectBoxByTwoGrp</span><span class="p">(</span><span class="n">g1</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">g2</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">g1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">g2</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">effectBox</span><span class="p">:</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="n">isInBox</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">number</span><span class="p">):</span>
                        <span class="n">possiblePos</span> <span class="o">=</span> <span class="n">GetCanNotSeenInBox</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">g1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">g2</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                        <span class="n">pos2</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">possiblePos</span><span class="p">)</span>
                        <span class="k">for</span> <span class="n">pos</span> <span class="ow">in</span> <span class="n">pos2</span><span class="p">:</span>
                            <span class="k">if</span> <span class="ow">not</span> <span class="n">isPossibleByX</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">number</span><span class="p">,</span> <span class="n">groups</span><span class="o">=</span><span class="n">groups</span><span class="p">)</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">isPossibleByY</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">number</span><span class="p">,</span> <span class="n">groups</span><span class="o">=</span><span class="n">groups</span><span class="p">):</span>
                                <span class="n">possiblePos</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span>
                        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">possiblePos</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                            <span class="c"># if only one possible pos means it is the position of the number</span>
                            <span class="c"># and it will use the same function to continue find another possible position for the number</span>
                            <span class="n">amt</span> <span class="o">=</span> <span class="n">amt</span> <span class="o">+</span> <span class="mi">1</span>
                            <span class="n">setNumber</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">possiblePos</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">number</span><span class="p">,</span> <span class="n">logic</span><span class="o">=</span><span class="s">&quot;InObviousByTwoGroup for {0}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">number</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">amt</span>

</div>
<div class="viewcode-block" id="GetIndirectNumberInBox"><a class="viewcode-back" href="../../matrix.html#matrix.matrix.GetIndirectNumberInBox">[docs]</a><span class="k">def</span> <span class="nf">GetIndirectNumberInBox</span><span class="p">(</span><span class="n">possiblePos</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Get Indirect Number Group in a box by possible positions of a number</span>
<span class="sd">    judge by if all ther possiblePos has a same direction, means that those have same x or y</span>
<span class="sd">    if so, it will return (x, 0) or (0, y), otherwise will return (0, 0)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">flag</span> <span class="o">=</span> <span class="bp">True</span>
    <span class="n">direction</span> <span class="o">=</span> <span class="s">&quot;x&quot;</span>
    <span class="k">for</span> <span class="n">p1</span> <span class="ow">in</span> <span class="n">possiblePos</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">p2</span> <span class="ow">in</span> <span class="n">possiblePos</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">p1</span> <span class="o">==</span> <span class="n">p2</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="k">if</span> <span class="n">p1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="n">p2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">and</span> <span class="n">p1</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="n">p2</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
                <span class="n">flag</span> <span class="o">=</span> <span class="bp">False</span>
                <span class="k">break</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c"># check direction</span>
                <span class="k">if</span> <span class="n">p1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="n">p2</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
                    <span class="n">direction</span> <span class="o">=</span> <span class="s">&quot;y&quot;</span>
    <span class="k">if</span> <span class="n">flag</span><span class="p">:</span>
        <span class="n">rtn</span> <span class="o">=</span> <span class="p">(</span><span class="n">p1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">0</span><span class="p">)</span> <span class="k">if</span> <span class="n">direction</span> <span class="o">==</span> <span class="s">&quot;x&quot;</span> <span class="k">else</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">p1</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">rtn</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">rtn</span>

</div>
<div class="viewcode-block" id="GetNotAssignedByX"><a class="viewcode-back" href="../../matrix.html#matrix.matrix.GetNotAssignedByX">[docs]</a><span class="k">def</span> <span class="nf">GetNotAssignedByX</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Get not yet be assigned positions and number by x&quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">m</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">9</span><span class="p">:</span>    <span class="c"># check if that x line has been filled</span>
        <span class="k">return</span> <span class="p">[],</span> <span class="p">[]</span>
    <span class="n">Pos</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
    <span class="n">Num</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">m</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">Pos</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">x</span><span class="p">,</span> <span class="n">i</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">Num</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">i</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">Pos</span><span class="p">,</span> <span class="n">Num</span>

</div>
<div class="viewcode-block" id="CheckOnlyOnePossible"><a class="viewcode-back" href="../../matrix.html#matrix.matrix.CheckOnlyOnePossible">[docs]</a><span class="k">def</span> <span class="nf">CheckOnlyOnePossible</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">amt</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Checking the position which only has one possible value&quot;&quot;&quot;</span>

    <span class="c">#print(&quot;Step #3: CheckOnlyOnePossible: &quot;.format(amt))</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">],</span><span class="nb">list</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">])</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">amt</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="n">setNumber</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">),</span> <span class="n">p</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">logic</span><span class="o">=</span><span class="s">&quot;OnlyOnePossibleNumber!&quot;</span><span class="p">)</span>
                <span class="c"># When setNumber, the p LIST has been changed, so it should be stopped, so call self again</span>
                <span class="c"># to make sure that all position by x has been checked, then just return</span>
                <span class="k">return</span> <span class="mi">1</span>  <span class="c"># just get one then return, let other to process</span>
                <span class="c">#amt = CheckOnlyOnePossible(m, n, p, amt=amt)</span>
                <span class="c">#return amt</span>
    <span class="k">return</span> <span class="n">amt</span>

</div>
<div class="viewcode-block" id="CheckOnlyOnePossibleByPos"><a class="viewcode-back" href="../../matrix.html#matrix.matrix.CheckOnlyOnePossibleByPos">[docs]</a><span class="k">def</span> <span class="nf">CheckOnlyOnePossibleByPos</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">amt</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Checking the same positions is only one possible for the number&quot;&quot;&quot;</span>

    <span class="c">#print(&quot;Step #2: CheckOnlyOnePossibleByPos: {0}&quot;.format(amt))</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">):</span>
        <span class="n">Pos</span><span class="p">,</span> <span class="n">Num</span> <span class="o">=</span> <span class="n">GetNotAssignedByX</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">Pos</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="c">#test every possible number which will only in one position?</span>
        <span class="k">for</span> <span class="n">num</span> <span class="ow">in</span> <span class="n">Num</span><span class="p">:</span>
            <span class="n">k</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">idx</span> <span class="o">=</span> <span class="p">()</span>
            <span class="k">for</span> <span class="n">p1</span> <span class="ow">in</span> <span class="n">Pos</span><span class="p">:</span>
                <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">p1</span>
                <span class="k">if</span> <span class="n">num</span> <span class="ow">in</span> <span class="n">p</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]:</span>
                    <span class="n">k</span> <span class="o">+=</span> <span class="mi">1</span>
                    <span class="c"># if the count has over 1, it cannot be the only one, then test next number</span>
                    <span class="k">if</span> <span class="n">k</span> <span class="o">&gt;=</span> <span class="mi">2</span><span class="p">:</span>
                        <span class="k">break</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">idx</span> <span class="o">=</span> <span class="n">p1</span>
            <span class="k">if</span> <span class="n">k</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">amt</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="n">setNumber</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">idx</span><span class="p">,</span> <span class="n">num</span><span class="p">,</span> <span class="n">logic</span><span class="o">=</span><span class="s">&quot;OnlyOnePositionByPos for {0}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">num</span><span class="p">))</span>
                <span class="c"># When setNumber, the p LIST has been changed, so it should be stopped, so call self again</span>
                <span class="c"># to make sure that all position by x has been checked, then just return</span>
                <span class="c"># Just solve one, left to let other method to check</span>
                <span class="c"># amt = CheckOnlyOnePossibleByPos(m, n, p, amt=amt)</span>
                <span class="k">return</span> <span class="n">amt</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">k</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
                    <span class="k">print</span><span class="p">(</span><span class="s">&quot;Here should not to be, it must be a bug!&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">amt</span>

</div>
<div class="viewcode-block" id="fillLastNumberByX"><a class="viewcode-back" href="../../matrix.html#matrix.matrix.fillLastNumberByX">[docs]</a><span class="k">def</span> <span class="nf">fillLastNumberByX</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">i</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;fill the x line&#39;s last number&quot;&quot;&quot;</span>

    <span class="n">num</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">)]</span>
    <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">idx</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">last</span> <span class="o">=</span> <span class="n">idx</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">num</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">idx</span><span class="p">])</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">num</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&quot;Error: this is not the last number condition when x={0}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
        <span class="c">#print(m, i, last, num)</span>
        <span class="c">#sys.exit(0)</span>
        <span class="k">return</span> <span class="bp">False</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">setNumber</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">last</span><span class="p">),</span> <span class="n">num</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">logic</span><span class="o">=</span><span class="s">&quot;fillLastNumberbyX at LineX={0}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
        <span class="k">return</span> <span class="bp">True</span>

</div>
<div class="viewcode-block" id="fillLastNumberByY"><a class="viewcode-back" href="../../matrix.html#matrix.matrix.fillLastNumberByY">[docs]</a><span class="k">def</span> <span class="nf">fillLastNumberByY</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">i</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;fill the y line&#39;s last number&quot;&quot;&quot;</span>

    <span class="n">num</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">)]</span>
    <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">m</span><span class="p">[</span><span class="n">idx</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">last</span> <span class="o">=</span> <span class="n">idx</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">num</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">idx</span><span class="p">][</span><span class="n">i</span><span class="p">])</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">num</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&quot;Error: this is not the last number condition when y={0}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
        <span class="c">#print(m, i, last, num)</span>
        <span class="c">#sys.exit(0)</span>
        <span class="k">return</span> <span class="bp">False</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">setNumber</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="p">(</span><span class="n">last</span><span class="p">,</span> <span class="n">i</span><span class="p">),</span> <span class="n">num</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">logic</span><span class="o">=</span><span class="s">&quot;fillLastNumberbyY at LineY={0}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
        <span class="k">return</span> <span class="bp">True</span>

</div>
<div class="viewcode-block" id="fillLastNumberByBox"><a class="viewcode-back" href="../../matrix.html#matrix.matrix.fillLastNumberByBox">[docs]</a><span class="k">def</span> <span class="nf">fillLastNumberByBox</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">box</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;fill the Box&#39;s last number&quot;&quot;&quot;</span>

    <span class="n">Pos</span> <span class="o">=</span> <span class="n">GetAllPosInBox</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">box</span><span class="p">)</span>
    <span class="n">num</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">)]</span>
    <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">Pos</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">m</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">lastX</span><span class="p">,</span> <span class="n">lastY</span> <span class="o">=</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">num</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">])</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">num</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&quot;Error: this is not the last number condition when Box={0}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">box</span><span class="p">))</span>
        <span class="c">#print(m, box, lastX, lastY, num)</span>
        <span class="c">#sys.exit(0)</span>
        <span class="k">return</span> <span class="bp">False</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">setNumber</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="p">(</span><span class="n">lastX</span><span class="p">,</span> <span class="n">lastY</span><span class="p">),</span> <span class="n">num</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">logic</span><span class="o">=</span><span class="s">&quot;fillLastNumberbyBox at Box={0}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">box</span><span class="p">))</span>
        <span class="k">return</span> <span class="bp">True</span>
    
</div>
<div class="viewcode-block" id="CheckOnlyOnePossibleByNum"><a class="viewcode-back" href="../../matrix.html#matrix.matrix.CheckOnlyOnePossibleByNum">[docs]</a><span class="k">def</span> <span class="nf">CheckOnlyOnePossibleByNum</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">amt</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Check if there is only one number left in the same x, y or box&quot;&quot;&quot;</span>

    <span class="c">#print(&quot;Step #2: CheckOnlyOnePossibleByNum: {0}&quot;.format(amt))</span>
    <span class="c"># the same x</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">8</span> <span class="ow">and</span> <span class="n">fillLastNumberByX</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">i</span><span class="p">):</span>
            <span class="n">amt</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">return</span> <span class="n">CheckOnlyOnePossibleByNum</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">amt</span><span class="o">=</span><span class="n">amt</span><span class="p">)</span>

    <span class="c"># the same y</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">m</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="mi">8</span> <span class="ow">and</span> <span class="n">fillLastNumberByY</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">i</span><span class="p">):</span>
            <span class="n">amt</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">return</span> <span class="n">CheckOnlyOnePossibleByNum</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">amt</span><span class="o">=</span><span class="n">amt</span><span class="p">)</span>

    <span class="c"># the same box</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">):</span>
            <span class="c">#n[0][1..9] record the box&#39;s assigned numbers</span>
            <span class="n">idx</span> <span class="o">=</span> <span class="p">(</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="mi">3</span> <span class="o">+</span> <span class="n">j</span>
            <span class="k">if</span> <span class="n">n</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">idx</span><span class="p">]</span> <span class="o">==</span> <span class="mi">8</span> <span class="ow">and</span> <span class="n">fillLastNumberByBox</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)):</span>
                <span class="n">amt</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="k">return</span> <span class="n">CheckOnlyOnePossibleByNum</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">amt</span><span class="o">=</span><span class="n">amt</span><span class="p">)</span>
        
    <span class="c"># if has assigned one, check again by self</span>
    <span class="k">if</span> <span class="n">amt</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">CheckOnlyOnePossibleByNum</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">amt</span>

</div>
<div class="viewcode-block" id="SortedUnAssignedPosByPossibles"><a class="viewcode-back" href="../../matrix.html#matrix.matrix.SortedUnAssignedPosByPossibles">[docs]</a><span class="k">def</span> <span class="nf">SortedUnAssignedPosByPossibles</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">possibles</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Get unassign position&#39;s possible number list, format is [(p1,[n1,n2,...]),(p2,[n1, n2,...]),...]</span>
<span class="sd">    and Sorted By the possible numbers</span>
<span class="sd">    possibles: 0 for all, &gt;=2, mean get only the possible numbers for it</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">rtn</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">CheckIt</span> <span class="o">=</span> <span class="n">possibles</span> <span class="o">&gt;=</span> <span class="mi">2</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="k">if</span> <span class="n">CheckIt</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">])</span> <span class="o">!=</span> <span class="n">possibles</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="n">rtn</span><span class="o">.</span><span class="n">append</span><span class="p">(((</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">),</span> <span class="n">p</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]))</span>
    <span class="n">rtn</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">rtn</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">pos</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">pos</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
    <span class="k">return</span> <span class="n">rtn</span>

</div>
<div class="viewcode-block" id="TryError"><a class="viewcode-back" href="../../matrix.html#matrix.matrix.TryError">[docs]</a><span class="k">def</span> <span class="nf">TryError</span><span class="p">(</span><span class="nb">file</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">m</span><span class="o">=</span><span class="p">[],</span> <span class="n">n</span><span class="o">=</span><span class="p">[],</span> <span class="n">p</span><span class="o">=</span><span class="p">[],</span> <span class="n">depth</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Try Error method&quot;&quot;&quot;</span>

    <span class="k">global</span> <span class="n">records</span><span class="p">,</span> <span class="n">rec</span><span class="p">,</span> <span class="n">HasWritenPossible</span><span class="p">,</span> <span class="n">done</span><span class="p">,</span> <span class="n">error</span><span class="p">,</span> <span class="n">PrintStep</span>

    <span class="n">PrintStep</span> <span class="o">=</span> <span class="bp">False</span>
    <span class="k">if</span> <span class="nb">file</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">records</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c"># record how many steps have been taken</span>
        <span class="n">rec</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>  <span class="c"># record of step: (x, y, value, logic)</span>
        <span class="n">HasWritenPossible</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="n">done</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="n">error</span> <span class="o">=</span> <span class="bp">False</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="nb">file</span><span class="p">):</span>
            <span class="nb">file</span> <span class="o">=</span> <span class="s">&quot;data/&quot;</span> <span class="o">+</span> <span class="nb">file</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="nb">file</span><span class="p">,</span> <span class="s">&#39;r&#39;</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">IOError</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s">&#39;Cannot open&#39;</span><span class="p">,</span> <span class="nb">file</span><span class="p">)</span>
            <span class="k">return</span> <span class="bp">False</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="nb">file</span><span class="p">,</span> <span class="s">&#39;has&#39;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">readlines</span><span class="p">()),</span> <span class="s">&#39; defined!&#39;</span><span class="p">)</span>
            <span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">p</span> <span class="o">=</span> <span class="n">emptyMatrix</span><span class="p">()</span>

        <span class="n">readDefine</span><span class="p">(</span><span class="nb">file</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>

    <span class="n">m1</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
    <span class="n">n1</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
    <span class="n">p1</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
    <span class="n">depth</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="n">flag</span> <span class="o">=</span> <span class="bp">False</span>
    <span class="n">possibles</span> <span class="o">=</span> <span class="n">SortedUnAssignedPosByPossibles</span><span class="p">(</span><span class="n">m1</span><span class="p">,</span> <span class="n">p1</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">pos</span><span class="p">,</span> <span class="n">pset</span> <span class="ow">in</span> <span class="n">possibles</span><span class="p">:</span>
        <span class="n">k</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">pset</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">k</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">False</span>
        <span class="k">if</span> <span class="n">k</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">setNumber</span><span class="p">(</span><span class="n">m1</span><span class="p">,</span> <span class="n">n1</span><span class="p">,</span> <span class="n">p1</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">pset</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">logic</span><span class="o">=</span><span class="s">&quot;Only One!&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">isDone</span><span class="p">(</span><span class="n">m1</span><span class="p">):</span>
                <span class="n">done</span> <span class="o">=</span> <span class="bp">True</span>
                <span class="k">print</span><span class="p">(</span><span class="s">&quot;done!&quot;</span><span class="p">)</span>
                <span class="n">printMatrix</span><span class="p">(</span><span class="n">m1</span><span class="p">)</span>
                <span class="k">return</span> <span class="bp">True</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">TryError</span><span class="p">(</span><span class="n">m</span><span class="o">=</span><span class="n">m1</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="n">n1</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="n">p1</span><span class="p">,</span> <span class="n">depth</span><span class="o">=</span><span class="n">depth</span><span class="p">)</span>
        <span class="n">p2</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">p1</span><span class="p">)</span>
        <span class="n">n2</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">n1</span><span class="p">)</span>
        <span class="n">m2</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">m1</span><span class="p">)</span>
        <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">num</span> <span class="ow">in</span> <span class="n">pset</span><span class="p">:</span>
            <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">flag</span> <span class="o">=</span> <span class="bp">False</span>
            <span class="c">#print(&quot;Depth#{2}-{3}: try {0} to be {1} of {4}&quot;.format(pos, num, depth, i, pset))</span>
            <span class="k">if</span> <span class="n">isPossible</span><span class="p">(</span><span class="n">m1</span><span class="p">,</span> <span class="n">p1</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">num</span><span class="p">):</span>
                <span class="n">setNumber</span><span class="p">(</span><span class="n">m1</span><span class="p">,</span> <span class="n">n1</span><span class="p">,</span> <span class="n">p1</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">num</span><span class="p">,</span> <span class="n">logic</span><span class="o">=</span><span class="s">&quot;Try&quot;</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">isDone</span><span class="p">(</span><span class="n">m1</span><span class="p">):</span>
                    <span class="n">done</span> <span class="o">=</span> <span class="bp">True</span>
                    <span class="k">print</span><span class="p">(</span><span class="s">&quot;done!&quot;</span><span class="p">)</span>
                    <span class="n">printMatrix</span><span class="p">(</span><span class="n">m1</span><span class="p">)</span>
                    <span class="k">return</span> <span class="bp">True</span>
                <span class="n">flag</span> <span class="o">=</span> <span class="n">TryError</span><span class="p">(</span><span class="n">m</span><span class="o">=</span><span class="n">m1</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="n">n1</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="n">p1</span><span class="p">,</span> <span class="n">depth</span><span class="o">=</span><span class="n">depth</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">flag</span><span class="p">:</span>
                    <span class="k">break</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="c"># unset number</span>
                    <span class="c"># unsetNumber(m1, n1, p1, pos, num, pset, logic=&quot;Try&quot;)</span>
                    <span class="n">p1</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">p2</span><span class="p">)</span>
                    <span class="n">n1</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">n2</span><span class="p">)</span>
                    <span class="n">m1</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">m2</span><span class="p">)</span>
                    <span class="k">continue</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c">#print(&quot;Impossible for {0} to be {1} in set of {2}&quot;.format(pos, num, pset))</span>
                <span class="k">continue</span>
        <span class="k">if</span> <span class="n">flag</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">done</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">True</span>
            <span class="k">continue</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c">#print(&quot;Impossible for {0} in set of {1}&quot;.format(pos, pset))</span>
            <span class="k">return</span> <span class="bp">False</span>

</div>
<div class="viewcode-block" id="GetChains"><a class="viewcode-back" href="../../matrix.html#matrix.matrix.GetChains">[docs]</a><span class="k">def</span> <span class="nf">GetChains</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">Pos</span><span class="p">,</span> <span class="n">numbers</span><span class="o">=</span><span class="mi">2</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Get numbers Chains from a Pos list</span>
<span class="sd">    return: [([num1, num2,...], [pos1, pos2,...]),...]&quot;&quot;&quot;</span>

    <span class="c"># get the positions who&#39;s possible numbers is great than 1, and less or equal numbers</span>
    <span class="n">q</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">Pos</span><span class="p">:</span>
        <span class="n">k</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">])</span>
        <span class="k">if</span> <span class="mi">1</span> <span class="o">&lt;</span> <span class="n">k</span> <span class="o">&lt;=</span> <span class="n">numbers</span><span class="p">:</span>
            <span class="n">q</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">))</span>
    <span class="c"># if qualified positions is less than numbers, just return</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">q</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">numbers</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">[]</span>

    <span class="n">rtn</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">itertools</span><span class="o">.</span><span class="n">combinations</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="n">numbers</span><span class="p">):</span>
        <span class="n">s</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">c</span><span class="p">:</span>
            <span class="n">s</span> <span class="o">=</span> <span class="n">s</span> <span class="o">|</span> <span class="nb">set</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">])</span>
            <span class="c">#print(x, y, p[x][y], s)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="o">==</span> <span class="n">numbers</span><span class="p">:</span>
            <span class="n">rtn</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="nb">list</span><span class="p">(</span><span class="n">s</span><span class="p">),</span> <span class="nb">list</span><span class="p">(</span><span class="n">c</span><span class="p">)))</span>          
    <span class="k">return</span> <span class="n">rtn</span>

</div>
<div class="viewcode-block" id="ReduceByChain"><a class="viewcode-back" href="../../matrix.html#matrix.matrix.ReduceByChain">[docs]</a><span class="k">def</span> <span class="nf">ReduceByChain</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">numbers</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">chainpos</span><span class="p">,</span> <span class="n">logic</span><span class="o">=</span><span class="s">&quot;Reduced By Chain&quot;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Reduce numbers of positions of pos which other than positions of chainpos&quot;&quot;&quot;</span>

    <span class="n">reduces</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">sets</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">pos</span><span class="p">:</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span> <span class="ow">in</span> <span class="n">chainpos</span> <span class="ow">or</span> <span class="n">m</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="k">for</span> <span class="n">num</span> <span class="ow">in</span> <span class="n">numbers</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">num</span> <span class="ow">in</span> <span class="n">p</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]:</span>
                <span class="n">rtn</span> <span class="o">=</span> <span class="n">reduceNumber</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="n">num</span><span class="p">,</span> <span class="n">logic</span><span class="o">=</span><span class="n">logic</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">rtn</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>  <span class="c"># if set number, just return, let other method to deal with others</span>
                    <span class="n">sets</span> <span class="o">+=</span> <span class="mi">1</span>
                    <span class="k">return</span> <span class="n">reduces</span><span class="p">,</span> <span class="n">sets</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">reduces</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="n">reduces</span><span class="p">,</span> <span class="n">sets</span>

</div>
<div class="viewcode-block" id="ReduceByBoxChain"><a class="viewcode-back" href="../../matrix.html#matrix.matrix.ReduceByBoxChain">[docs]</a><span class="k">def</span> <span class="nf">ReduceByBoxChain</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Reduce By Box&#39;s chaing&quot;&quot;&quot;</span>

    <span class="n">reduces</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">sets</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">):</span>
            <span class="n">pos</span> <span class="o">=</span> <span class="n">GetAllPosInBox</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">),</span> <span class="n">method</span><span class="o">=</span><span class="s">&quot;u&quot;</span><span class="p">)</span>
            <span class="n">k</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">chainNums</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">):</span>    <span class="c"># just check 2, 3, 4 numbers&#39; chain</span>
                <span class="k">if</span> <span class="n">k</span> <span class="o">&lt;</span> <span class="n">chainNums</span><span class="p">:</span>  <span class="c"># if the unsign positions are little than chains, not need to check</span>
                    <span class="k">break</span>
                <span class="n">chains</span> <span class="o">=</span> <span class="n">GetChains</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">numbers</span><span class="o">=</span><span class="n">chainNums</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">numbers</span><span class="p">,</span> <span class="n">chainpos</span> <span class="ow">in</span> <span class="n">chains</span><span class="p">:</span>
                    <span class="n">amt</span><span class="p">,</span> <span class="n">sets</span> <span class="o">=</span> <span class="n">ReduceByChain</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">numbers</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">chainpos</span><span class="p">,</span> <span class="n">logic</span><span class="o">=</span><span class="s">&quot;ByBoxChain:{0}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">chainpos</span><span class="p">))</span>
                    <span class="n">reduces</span> <span class="o">+=</span> <span class="n">amt</span>
                    <span class="k">if</span> <span class="n">sets</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="n">reduces</span> <span class="o">+=</span> <span class="mi">1</span>
                        <span class="k">return</span> <span class="n">reduces</span><span class="p">,</span> <span class="n">sets</span>
    <span class="k">return</span> <span class="n">reduces</span><span class="p">,</span> <span class="n">sets</span>

</div>
<div class="viewcode-block" id="ReduceByLineChain"><a class="viewcode-back" href="../../matrix.html#matrix.matrix.ReduceByLineChain">[docs]</a><span class="k">def</span> <span class="nf">ReduceByLineChain</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">direction</span><span class="o">=</span><span class="s">&quot;x&quot;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Reduce By Line chain</span>
<span class="sd">    direction: x: the same x postions, y: the same y positions</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">reduces</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">sets</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">):</span>
        <span class="n">pos</span> <span class="o">=</span> <span class="n">GetAllPosOfX</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s">&quot;u&quot;</span><span class="p">)</span> <span class="k">if</span> <span class="n">direction</span> <span class="o">==</span> <span class="s">&quot;x&quot;</span> <span class="k">else</span> <span class="n">GetAllPosOfY</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s">&quot;u&quot;</span><span class="p">)</span>
        <span class="n">left</span> <span class="o">=</span> <span class="mi">9</span> <span class="o">-</span> <span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="n">direction</span> <span class="o">==</span> <span class="s">&quot;x&quot;</span> <span class="k">else</span> <span class="n">m</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">i</span><span class="p">])</span>
        <span class="n">k</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">chainNums</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">):</span>    <span class="c"># just check 2, 3, 4 numbers&#39; chain</span>
            <span class="k">if</span> <span class="n">k</span> <span class="o">&lt;</span> <span class="n">chainNums</span> <span class="ow">or</span> <span class="n">chainNums</span> <span class="o">&gt;=</span> <span class="n">left</span><span class="p">:</span>  <span class="c">#if the unsign positions are little than chains,  or great than the left positions, not need to check</span>
                <span class="k">break</span>
            <span class="n">chains</span> <span class="o">=</span> <span class="n">GetChains</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">numbers</span><span class="o">=</span><span class="n">chainNums</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">numbers</span><span class="p">,</span> <span class="n">chainpos</span> <span class="ow">in</span> <span class="n">chains</span><span class="p">:</span>
                <span class="c"># print(numbers, chainpos, chainNums)</span>
                <span class="n">amt</span><span class="p">,</span> <span class="n">sets</span> <span class="o">=</span> <span class="n">ReduceByChain</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">numbers</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">chainpos</span><span class="p">,</span> <span class="n">logic</span><span class="o">=</span><span class="s">&quot;ByLineChain:{0}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">chainpos</span><span class="p">))</span>
                <span class="n">reduces</span> <span class="o">=</span> <span class="n">reduces</span> <span class="o">+</span> <span class="n">amt</span>
                <span class="k">if</span> <span class="n">sets</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">reduces</span> <span class="o">+=</span> <span class="mi">1</span>
                    <span class="k">return</span> <span class="n">reduces</span><span class="p">,</span> <span class="n">sets</span>
    <span class="k">return</span> <span class="n">reduces</span><span class="p">,</span> <span class="n">sets</span>

</div>
<div class="viewcode-block" id="ReduceByTwoPossible"><a class="viewcode-back" href="../../matrix.html#matrix.matrix.ReduceByTwoPossible">[docs]</a><span class="k">def</span> <span class="nf">ReduceByTwoPossible</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Reduce by a postion&#39;s two possible number</span>
<span class="sd">    we assume the position set the first, then test the second number where the first number in of the same box, samy x, and same y</span>
<span class="sd">    if we can get the number in the other position, we can make sure that in the other positions will not have the first number</span>
<span class="sd">    because both of two possible number have been tested.</span>
<span class="sd">    return: reduces, sets</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">possibles</span> <span class="o">=</span> <span class="n">SortedUnAssignedPosByPossibles</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">possibles</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">pos</span><span class="p">,</span> <span class="n">numbers</span> <span class="ow">in</span> <span class="n">possibles</span><span class="p">:</span>
        <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">pos</span>
        <span class="n">b</span> <span class="o">=</span> <span class="n">WhichBox</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span>
        <span class="c"># check the first number as first, then check the second number as first</span>
        <span class="n">r0</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
        <span class="n">r1</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>  <span class="c"># the result records of the two value</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">):</span>
            <span class="n">first</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">1</span> <span class="k">else</span> <span class="n">p</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">second</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">1</span> <span class="k">else</span> <span class="n">p</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">):</span>   <span class="c"># Check Box, x line, y line</span>
                <span class="c"># Get the effect positions which has the possible number in a Box</span>
                <span class="k">if</span> <span class="n">j</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>  <span class="c"># box</span>
                    <span class="n">effects</span> <span class="o">=</span> <span class="n">GetAllPosInBox</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s">&#39;u&#39;</span><span class="p">,</span> <span class="n">num</span><span class="o">=</span><span class="n">first</span><span class="p">,</span> <span class="n">diff</span><span class="o">=</span><span class="p">[</span><span class="n">pos</span><span class="p">])</span>
                <span class="k">elif</span> <span class="n">j</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>  <span class="c"># x line</span>
                    <span class="n">effects</span> <span class="o">=</span> <span class="n">GetAllPosOfX</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s">&#39;u&#39;</span><span class="p">,</span> <span class="n">num</span><span class="o">=</span><span class="n">first</span><span class="p">,</span> <span class="n">diff</span><span class="o">=</span><span class="p">[</span><span class="n">pos</span><span class="p">])</span>
                <span class="k">else</span><span class="p">:</span>  <span class="c"># y line</span>
                    <span class="n">effects</span> <span class="o">=</span> <span class="n">GetAllPosOfY</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s">&#39;u&#39;</span><span class="p">,</span> <span class="n">num</span><span class="o">=</span><span class="n">first</span><span class="p">,</span> <span class="n">diff</span><span class="o">=</span><span class="p">[</span><span class="n">pos</span><span class="p">])</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">effects</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="k">continue</span>
                <span class="n">rtn</span><span class="p">,</span> <span class="n">m1</span><span class="p">,</span> <span class="n">r</span> <span class="o">=</span> <span class="n">Emulator</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">second</span><span class="p">,</span> <span class="n">targets</span><span class="o">=</span><span class="n">effects</span><span class="p">,</span> <span class="n">checkval</span><span class="o">=</span><span class="n">first</span><span class="p">)</span>
                <span class="c">#print(pos, first, second, effects, rtn)</span>
                <span class="k">if</span> <span class="n">rtn</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>  <span class="c"># error, so the value must be the first</span>
                    <span class="n">setNumber</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">first</span><span class="p">,</span> <span class="n">logic</span><span class="o">=</span><span class="s">&quot;The Other Is Impossible By TwoPossible!&quot;</span><span class="p">)</span>
                    <span class="k">return</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span>
                <span class="k">elif</span> <span class="n">rtn</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>  <span class="c"># solve, so the value must be the second</span>
                    <span class="n">setNumber</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">second</span><span class="p">,</span> <span class="n">logic</span><span class="o">=</span><span class="s">&quot;This value can solve all By TwoPossible!&quot;</span><span class="p">)</span>
                    <span class="k">return</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span>
                <span class="k">elif</span> <span class="n">rtn</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>  <span class="c"># one of effect positions can be set to be the first value</span>
                    <span class="n">amt</span> <span class="o">=</span> <span class="n">ReduceByEmuResult</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">m1</span><span class="p">,</span> <span class="n">effects</span><span class="p">,</span> <span class="n">first</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">amt</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="k">return</span> <span class="n">amt</span><span class="p">,</span> <span class="mi">0</span>
                <span class="k">else</span><span class="p">:</span>  <span class="c"># rtn == 0, can&#39;t know anything, just continue</span>
                    <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                        <span class="n">r0</span> <span class="o">=</span> <span class="n">r0</span> <span class="o">+</span> <span class="n">r</span><span class="p">[</span><span class="n">records</span><span class="o">+</span><span class="mi">1</span><span class="p">:]</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">r1</span> <span class="o">=</span> <span class="n">r1</span> <span class="o">+</span> <span class="n">r</span><span class="p">[</span><span class="n">records</span><span class="o">+</span><span class="mi">1</span><span class="p">:]</span>
                    <span class="k">continue</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">r0</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">r1</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">reduces</span><span class="p">,</span> <span class="n">sets</span> <span class="o">=</span> <span class="n">CheckResultByTwoPossibleVal</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">r0</span><span class="p">,</span> <span class="n">r1</span><span class="p">,</span> <span class="n">logic</span><span class="o">=</span><span class="s">&quot;CheckResultByTwoPossibleVal of {0} at the Pos {1}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">],</span> <span class="n">pos</span><span class="p">))</span>
                <span class="k">if</span> <span class="n">reduces</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">sets</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">reduces</span><span class="p">,</span> <span class="n">sets</span>
    <span class="k">return</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span>

</div>
<div class="viewcode-block" id="ReduceByTwoPositionInBox"><a class="viewcode-back" href="../../matrix.html#matrix.matrix.ReduceByTwoPositionInBox">[docs]</a><span class="k">def</span> <span class="nf">ReduceByTwoPositionInBox</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Reduce by two postions which in the same box or same line, and have a common</span>
<span class="sd">    possible number which only be possible in these two different positions</span>
<span class="sd">    we assume the position set the first, then test the second number where the first number in of the same box, samy x, and same y</span>
<span class="sd">    if we can get the number in the other position, we can make sure that in the other positions will not have the first number</span>
<span class="sd">    because both of two possible number have been tested.</span>
<span class="sd">    return: reduces, sets</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">for</span> <span class="n">num</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">):</span>
                <span class="n">possible</span> <span class="o">=</span> <span class="n">GetAllPosInBox</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">),</span> <span class="n">method</span><span class="o">=</span><span class="s">&#39;u&#39;</span><span class="p">,</span> <span class="n">num</span><span class="o">=</span><span class="n">num</span><span class="p">)</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">possible</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">:</span>
                    <span class="k">continue</span>
                <span class="n">r0</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
                <span class="n">r1</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
                <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">):</span>
                    <span class="n">pos</span> <span class="o">=</span> <span class="n">possible</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="n">k</span> <span class="o">==</span> <span class="mi">1</span> <span class="k">else</span> <span class="n">possible</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                    <span class="n">theother</span> <span class="o">=</span> <span class="n">possible</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">if</span> <span class="n">k</span> <span class="o">==</span> <span class="mi">1</span> <span class="k">else</span> <span class="n">possible</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                    <span class="n">rtn</span><span class="p">,</span> <span class="n">m1</span><span class="p">,</span> <span class="n">r</span> <span class="o">=</span> <span class="n">Emulator</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">num</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">rtn</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>  <span class="c"># error, so the value must be the other</span>
                        <span class="n">setNumber</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">theother</span><span class="p">,</span> <span class="n">num</span><span class="p">,</span> <span class="n">logic</span><span class="o">=</span><span class="s">&quot;Impossible By TwoPosition!&quot;</span><span class="p">)</span>
                        <span class="k">return</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span>
                    <span class="k">elif</span> <span class="n">rtn</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>  <span class="c"># solve, so the value must be the second</span>
                        <span class="n">setNumber</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">num</span><span class="p">,</span> <span class="n">logic</span><span class="o">=</span><span class="s">&quot;This value can solve all By TwoPosition!&quot;</span><span class="p">)</span>
                        <span class="k">return</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span>
                    <span class="k">else</span><span class="p">:</span>  <span class="c"># rtn == 0, can&#39;t know anything, just continue</span>
                        <span class="k">if</span> <span class="n">k</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                            <span class="n">r0</span> <span class="o">=</span> <span class="n">r0</span> <span class="o">+</span> <span class="n">r</span><span class="p">[</span><span class="n">records</span><span class="o">+</span><span class="mi">1</span><span class="p">:]</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">r1</span> <span class="o">=</span> <span class="n">r1</span> <span class="o">+</span> <span class="n">r</span><span class="p">[</span><span class="n">records</span><span class="o">+</span><span class="mi">1</span><span class="p">:]</span>
                        <span class="k">continue</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">r0</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">r1</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">reduces</span><span class="p">,</span> <span class="n">sets</span> <span class="o">=</span> <span class="n">CheckResultByTwoPossibleVal</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">r0</span><span class="p">,</span> <span class="n">r1</span><span class="p">,</span> <span class="n">logic</span><span class="o">=</span><span class="s">&quot;CheckResultByTwoPosition of {0}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">possible</span><span class="p">))</span>
                    <span class="k">if</span> <span class="n">reduces</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">sets</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="k">return</span> <span class="n">reduces</span><span class="p">,</span> <span class="n">sets</span>
    <span class="k">return</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span>

</div>
<div class="viewcode-block" id="ReduceByTwoPositionOfLine"><a class="viewcode-back" href="../../matrix.html#matrix.matrix.ReduceByTwoPositionOfLine">[docs]</a><span class="k">def</span> <span class="nf">ReduceByTwoPositionOfLine</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">direction</span><span class="o">=</span><span class="s">&quot;x&quot;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Reduce by two postions which in the same line, and have a common</span>
<span class="sd">    possible number which only be possible in these two different positions</span>
<span class="sd">    we assume the position set the first, then test the second number where the first number in of the same box, samy x, and same y</span>
<span class="sd">    if we can get the number in the other position, we can make sure that in the other positions will not have the first number</span>
<span class="sd">    because both of two possible number have been tested.</span>
<span class="sd">    return: reduces, sets&quot;&quot;&quot;</span>

    <span class="k">for</span> <span class="n">num</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">direction</span> <span class="o">==</span> <span class="s">&quot;x&quot;</span><span class="p">:</span>
                <span class="n">possible</span> <span class="o">=</span> <span class="n">GetAllPosOfX</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s">&#39;u&#39;</span><span class="p">,</span> <span class="n">num</span><span class="o">=</span><span class="n">num</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">possible</span> <span class="o">=</span> <span class="n">GetAllPosOfY</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s">&#39;u&#39;</span><span class="p">,</span> <span class="n">num</span><span class="o">=</span><span class="n">num</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">possible</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="k">if</span> <span class="n">WhichBox</span><span class="p">(</span><span class="n">possible</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">==</span> <span class="n">WhichBox</span><span class="p">(</span><span class="n">possible</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
                <span class="k">continue</span>
            <span class="n">r0</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
            <span class="n">r1</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">):</span>
                <span class="n">pos</span> <span class="o">=</span> <span class="n">possible</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="n">k</span> <span class="o">==</span> <span class="mi">1</span> <span class="k">else</span> <span class="n">possible</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                <span class="n">theother</span> <span class="o">=</span> <span class="n">possible</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">if</span> <span class="n">k</span><span class="o">==</span><span class="mi">1</span> <span class="k">else</span> <span class="n">possible</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">rtn</span><span class="p">,</span> <span class="n">m1</span><span class="p">,</span> <span class="n">r</span> <span class="o">=</span> <span class="n">Emulator</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">num</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">rtn</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>  <span class="c"># error, so the value must be the other</span>
                    <span class="n">setNumber</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">theother</span><span class="p">,</span> <span class="n">num</span><span class="p">,</span> <span class="n">logic</span><span class="o">=</span><span class="s">&quot;Impossible By TwoPosition Of a Line!&quot;</span><span class="p">)</span>
                    <span class="k">return</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span>
                <span class="k">elif</span> <span class="n">rtn</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>  <span class="c"># solve, so the value must be the second</span>
                    <span class="n">setNumber</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">num</span><span class="p">,</span> <span class="n">logic</span><span class="o">=</span><span class="s">&quot;This value can solve all By TwoPosition Of a Line!&quot;</span><span class="p">)</span>
                    <span class="k">return</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span>
                <span class="k">else</span><span class="p">:</span>  <span class="c"># rtn == 0, can&#39;t know anything, just continue</span>
                    <span class="k">if</span> <span class="n">k</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                        <span class="n">r0</span> <span class="o">=</span> <span class="n">r0</span> <span class="o">+</span> <span class="n">r</span><span class="p">[</span><span class="n">records</span><span class="o">+</span><span class="mi">1</span><span class="p">:]</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">r1</span> <span class="o">=</span> <span class="n">r1</span> <span class="o">+</span> <span class="n">r</span><span class="p">[</span><span class="n">records</span><span class="o">+</span><span class="mi">1</span><span class="p">:]</span>
                    <span class="k">continue</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">r0</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">r1</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">reduces</span><span class="p">,</span> <span class="n">sets</span> <span class="o">=</span> <span class="n">CheckResultByTwoPossibleVal</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">r0</span><span class="p">,</span> <span class="n">r1</span><span class="p">,</span> <span class="n">logic</span><span class="o">=</span><span class="s">&quot;CheckResultByTwoPosition of {0}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">possible</span><span class="p">))</span>
                <span class="k">if</span> <span class="n">reduces</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">sets</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">reduces</span><span class="p">,</span> <span class="n">sets</span>
    <span class="k">return</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span>

</div>
<div class="viewcode-block" id="CheckResultByTwoPossibleVal"><a class="viewcode-back" href="../../matrix.html#matrix.matrix.CheckResultByTwoPossibleVal">[docs]</a><span class="k">def</span> <span class="nf">CheckResultByTwoPossibleVal</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">r0</span><span class="p">,</span> <span class="n">r1</span><span class="p">,</span> <span class="n">logic</span><span class="o">=</span><span class="s">&quot;CheckResultByTwoPossible&quot;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Check two emulate result records from a number only have two possible position in a box, line;</span>
<span class="sd">    or a postion only have two possible numbers,</span>
<span class="sd">    if they have same record or not!</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">reduces</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">sets</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">x0</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">v0</span><span class="p">,</span> <span class="n">t0</span><span class="p">,</span> <span class="n">logic0</span> <span class="ow">in</span> <span class="n">r0</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">v1</span><span class="p">,</span> <span class="n">t1</span><span class="p">,</span> <span class="n">login1</span> <span class="ow">in</span> <span class="n">r1</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">x1</span> <span class="o">==</span> <span class="n">x0</span> <span class="ow">and</span> <span class="n">y1</span> <span class="o">==</span> <span class="n">y0</span> <span class="ow">and</span> <span class="n">v1</span> <span class="o">==</span> <span class="n">v0</span> <span class="ow">and</span> <span class="n">t1</span> <span class="o">==</span> <span class="n">t0</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">t1</span> <span class="o">==</span> <span class="s">&quot;s&quot;</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">m</span><span class="p">[</span><span class="n">x1</span><span class="p">][</span><span class="n">y1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="n">sets</span> <span class="o">+=</span> <span class="mi">1</span>
                        <span class="n">setNumber</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">),</span> <span class="n">v1</span><span class="p">,</span> <span class="n">logic</span><span class="o">=</span><span class="n">logic</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="n">x1</span><span class="p">][</span><span class="n">y1</span><span class="p">],</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">and</span> <span class="n">v1</span> <span class="ow">in</span> <span class="n">p</span><span class="p">[</span><span class="n">x1</span><span class="p">][</span><span class="n">y1</span><span class="p">]:</span>
                        <span class="n">reduces</span> <span class="o">+=</span> <span class="mi">1</span>
                        <span class="n">reduceNumber</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">),</span> <span class="n">v1</span><span class="p">,</span> <span class="n">logic</span><span class="o">=</span><span class="n">logic</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">reduces</span><span class="p">,</span> <span class="n">sets</span>
                    
</div>
<div class="viewcode-block" id="ReduceByEmuResult"><a class="viewcode-back" href="../../matrix.html#matrix.matrix.ReduceByEmuResult">[docs]</a><span class="k">def</span> <span class="nf">ReduceByEmuResult</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">m1</span><span class="p">,</span> <span class="n">possible</span><span class="p">,</span> <span class="n">v</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Reduce v from some postions by emulate result m1&quot;&quot;&quot;</span>

    <span class="n">HasSet</span> <span class="o">=</span> <span class="bp">False</span>
    <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">possible</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">m1</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]</span> <span class="o">==</span> <span class="n">v</span><span class="p">:</span>
            <span class="n">HasSet</span> <span class="o">=</span> <span class="bp">True</span>
            <span class="k">break</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">HasSet</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">0</span>
    <span class="n">possible</span><span class="o">.</span><span class="n">remove</span><span class="p">((</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">))</span>
    <span class="n">amt</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span> <span class="ow">in</span> <span class="n">possible</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">m</span><span class="p">[</span><span class="n">x1</span><span class="p">][</span><span class="n">y1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">p</span><span class="p">[</span><span class="n">x1</span><span class="p">][</span><span class="n">y1</span><span class="p">]:</span>
            <span class="n">rtn</span> <span class="o">=</span> <span class="n">reduceNumber</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">),</span> <span class="n">v</span><span class="p">,</span> <span class="n">logic</span><span class="o">=</span><span class="s">&quot;ReduceByEmuResult!&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">rtn</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">amt</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="n">amt</span>

</div>
<div class="viewcode-block" id="CheckVal"><a class="viewcode-back" href="../../matrix.html#matrix.matrix.CheckVal">[docs]</a><span class="k">def</span> <span class="nf">CheckVal</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">v</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Check if one of the positions has been set the value&quot;&quot;&quot;</span>

    <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">pos</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">m</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]</span> <span class="o">==</span> <span class="n">v</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">True</span>
    <span class="k">return</span> <span class="bp">False</span>

</div>
<div class="viewcode-block" id="Emulator"><a class="viewcode-back" href="../../matrix.html#matrix.matrix.Emulator">[docs]</a><span class="k">def</span> <span class="nf">Emulator</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">targets</span><span class="o">=</span><span class="p">[],</span> <span class="n">checkval</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Emulator</span>
<span class="sd">    emulate the pos to be set v, then start to use some basic methods to try to solve</span>
<span class="sd">    it will stop when and return::</span>
<span class="sd">    1: one of the targets have been set the checkval</span>
<span class="sd">    2: isDone</span>
<span class="sd">    -1: error is True</span>
<span class="sd">    0: all basic methods have been tested, and can&#39;t solve</span>
<span class="sd">    and the result matrix</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">global</span> <span class="n">records</span><span class="p">,</span> <span class="n">rec</span><span class="p">,</span> <span class="n">HasWritenPossible</span><span class="p">,</span> <span class="n">done</span><span class="p">,</span> <span class="n">error</span><span class="p">,</span> <span class="n">PrintStep</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">targets</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">CheckTarget</span> <span class="o">=</span> <span class="bp">True</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">CheckTarget</span> <span class="o">=</span> <span class="bp">False</span>

    <span class="n">recSave</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">rec</span><span class="p">)</span>
    <span class="n">recordsSave</span> <span class="o">=</span> <span class="n">records</span>
    <span class="n">m1</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
    <span class="n">n1</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
    <span class="n">p1</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>

    <span class="n">PrintStep</span> <span class="o">=</span> <span class="bp">False</span>
    <span class="n">setNumber</span><span class="p">(</span><span class="n">m1</span><span class="p">,</span> <span class="n">n1</span><span class="p">,</span> <span class="n">p1</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">logic</span><span class="o">=</span><span class="s">&quot;Emulator Start!&quot;</span><span class="p">)</span>

    <span class="n">nTry</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">nRtn</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>

        <span class="c"># check</span>
        <span class="k">if</span> <span class="n">isDone</span><span class="p">(</span><span class="n">m1</span><span class="p">):</span>
            <span class="n">nRtn</span> <span class="o">=</span> <span class="mi">2</span>
            <span class="k">break</span>
        <span class="k">if</span> <span class="n">CheckTarget</span> <span class="ow">and</span> <span class="n">CheckVal</span><span class="p">(</span><span class="n">m1</span><span class="p">,</span> <span class="n">targets</span><span class="p">,</span> <span class="n">checkval</span><span class="p">):</span>
            <span class="n">nRtn</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="k">break</span>
        <span class="k">if</span> <span class="n">error</span><span class="p">:</span>
            <span class="n">nRtn</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
            <span class="k">break</span>

        <span class="n">nTry</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">nHasSet</span> <span class="o">=</span> <span class="n">m1</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
        
        <span class="c"># step#0, is there a line or a box which has only one position left?</span>
        <span class="k">if</span> <span class="n">CheckOnlyOnePossibleByNum</span><span class="p">(</span><span class="n">m1</span><span class="p">,</span> <span class="n">n1</span><span class="p">,</span> <span class="n">p1</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">continue</span>
            
        <span class="c"># step#1, Check Obvious by one position</span>
        <span class="k">if</span> <span class="n">CheckObviousByOne</span><span class="p">(</span><span class="n">m1</span><span class="p">,</span> <span class="n">n1</span><span class="p">,</span> <span class="n">p1</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">continue</span>
    
        <span class="c"># step#2</span>
        <span class="k">if</span> <span class="n">CheckObvious</span><span class="p">(</span><span class="n">m1</span><span class="p">,</span> <span class="n">n1</span><span class="p">,</span> <span class="n">p1</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">continue</span>

        <span class="c"># step#3, Reduce number by the Box Group number, and set it if it only one possible number left</span>
        <span class="k">if</span> <span class="n">CheckInObvious</span><span class="p">(</span><span class="n">m1</span><span class="p">,</span> <span class="n">n1</span><span class="p">,</span> <span class="n">p1</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">continue</span>

        <span class="c"># step #4, check Only One Possible By Position</span>
        <span class="k">if</span> <span class="n">CheckOnlyOnePossibleByPos</span><span class="p">(</span><span class="n">m1</span><span class="p">,</span> <span class="n">n1</span><span class="p">,</span> <span class="n">p1</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">continue</span>

        <span class="c"># step #5, check Only One Possible</span>
        <span class="k">if</span> <span class="n">CheckOnlyOnePossible</span><span class="p">(</span><span class="n">m1</span><span class="p">,</span> <span class="n">n1</span><span class="p">,</span> <span class="n">p1</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">continue</span>

        <span class="c"># step #6, reduce number by Box Group</span>
        <span class="n">reduces</span><span class="p">,</span> <span class="n">sets</span> <span class="o">=</span> <span class="n">ReduceByBoxGroup</span><span class="p">(</span><span class="n">m1</span><span class="p">,</span> <span class="n">n1</span><span class="p">,</span> <span class="n">p1</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">reduces</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">sets</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">continue</span>

        <span class="c"># step #7, reduce number by Box Chain</span>
        <span class="n">reduces</span><span class="p">,</span> <span class="n">sets</span> <span class="o">=</span> <span class="n">ReduceByBoxChain</span><span class="p">(</span><span class="n">m1</span><span class="p">,</span> <span class="n">n1</span><span class="p">,</span> <span class="n">p1</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">reduces</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">sets</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">continue</span>

        <span class="c"># step #8, reduce number by X Line Chain </span>
        <span class="n">reduces</span><span class="p">,</span> <span class="n">sets</span> <span class="o">=</span> <span class="n">ReduceByLineChain</span><span class="p">(</span><span class="n">m1</span><span class="p">,</span> <span class="n">n1</span><span class="p">,</span> <span class="n">p1</span><span class="p">,</span> <span class="n">direction</span><span class="o">=</span><span class="s">&quot;x&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">reduces</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">sets</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">continue</span>

        <span class="c"># step #9, reduce number by Y Line Chain</span>
        <span class="n">reduces</span><span class="p">,</span> <span class="n">sets</span> <span class="o">=</span> <span class="n">ReduceByLineChain</span><span class="p">(</span><span class="n">m1</span><span class="p">,</span> <span class="n">n1</span><span class="p">,</span> <span class="n">p1</span><span class="p">,</span> <span class="n">direction</span><span class="o">=</span><span class="s">&quot;y&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">reduces</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">sets</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">continue</span>

        <span class="c"># check</span>
        <span class="k">if</span> <span class="n">isDone</span><span class="p">(</span><span class="n">m1</span><span class="p">):</span>
            <span class="n">nRtn</span> <span class="o">=</span> <span class="mi">2</span>
            <span class="k">break</span>
        <span class="k">if</span> <span class="n">CheckTarget</span> <span class="ow">and</span> <span class="n">CheckVal</span><span class="p">(</span><span class="n">m1</span><span class="p">,</span> <span class="n">targets</span><span class="p">,</span> <span class="n">checkval</span><span class="p">):</span>
            <span class="n">nRtn</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="k">break</span>
        <span class="k">if</span> <span class="n">error</span><span class="p">:</span>
            <span class="n">nRtn</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
            <span class="k">break</span>
        <span class="k">break</span>

    <span class="c"># restore</span>
    <span class="n">error</span> <span class="o">=</span> <span class="bp">False</span>
    <span class="n">done</span> <span class="o">=</span> <span class="bp">False</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">rec</span><span class="p">)</span>
    <span class="n">rec</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">recSave</span><span class="p">)</span>
    <span class="n">records</span> <span class="o">=</span> <span class="n">recordsSave</span>
    <span class="n">PrintStep</span> <span class="o">=</span> <span class="bp">True</span>
    
    <span class="k">return</span> <span class="n">nRtn</span><span class="p">,</span> <span class="n">m1</span><span class="p">,</span> <span class="n">r</span>

</div>
<div class="viewcode-block" id="main"><a class="viewcode-back" href="../../matrix.html#matrix.matrix.main">[docs]</a><span class="k">def</span> <span class="nf">main</span><span class="p">(</span><span class="nb">file</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;main program&quot;&quot;&quot;</span>

    <span class="k">global</span> <span class="n">records</span><span class="p">,</span> <span class="n">rec</span><span class="p">,</span> <span class="n">HasWritenPossible</span><span class="p">,</span> <span class="n">done</span><span class="p">,</span> <span class="n">error</span>

    <span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
    <span class="n">limitMethods</span> <span class="o">=</span> <span class="bp">False</span> <span class="k">if</span> <span class="n">methods</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">else</span> <span class="bp">True</span>
    <span class="n">records</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c"># record how many steps have been taken</span>
    <span class="n">rec</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>  <span class="c"># record of step: (x, y, value, logic)</span>
    <span class="n">HasWritenPossible</span> <span class="o">=</span> <span class="bp">False</span>
    <span class="n">done</span> <span class="o">=</span> <span class="bp">False</span>
    <span class="n">error</span> <span class="o">=</span> <span class="bp">False</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="nb">file</span><span class="p">):</span>
        <span class="nb">file</span> <span class="o">=</span> <span class="s">&quot;data/&quot;</span> <span class="o">+</span> <span class="nb">file</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="nb">file</span><span class="p">,</span> <span class="s">&#39;r&#39;</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">IOError</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&#39;Cannot open&#39;</span><span class="p">,</span> <span class="nb">file</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">False</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="nb">file</span><span class="p">,</span> <span class="s">&#39;has&#39;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">readlines</span><span class="p">()),</span> <span class="s">&#39; defined!&#39;</span><span class="p">)</span>
        <span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

    <span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">p</span> <span class="o">=</span> <span class="n">emptyMatrix</span><span class="p">()</span>

    <span class="n">readDefine</span><span class="p">(</span><span class="nb">file</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>

    <span class="n">nTry</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">while</span> <span class="ow">not</span> <span class="n">isDone</span><span class="p">(</span><span class="n">m</span><span class="p">):</span>

        <span class="n">nTry</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="c"># step#0, is there a line or a box which has only one position left?</span>
        <span class="n">nHasSet0</span> <span class="o">=</span> <span class="n">m</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">amt</span> <span class="o">=</span> <span class="n">CheckOnlyOnePossibleByNum</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&quot;By Method#0, Try#{1}, we set {0} positions!&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">nHasSet0</span><span class="p">,</span> <span class="n">nTry</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">isDone</span><span class="p">(</span><span class="n">m</span><span class="p">):</span>
            <span class="k">break</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">amt</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">continue</span>

        <span class="k">if</span> <span class="n">limitMethods</span> <span class="ow">and</span> <span class="n">methods</span> <span class="o">&lt;=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">m</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">nHasSet0</span><span class="p">:</span>
            <span class="k">break</span>
            
            
        <span class="c"># step#1, Check Obvious by one position</span>
        <span class="n">nHasSet1</span> <span class="o">=</span> <span class="n">m</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">amt</span> <span class="o">=</span> <span class="n">CheckObviousByOne</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&quot;By Method#1, Try#{1}, we set {0} positions!&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">nHasSet1</span><span class="p">,</span> <span class="n">nTry</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">isDone</span><span class="p">(</span><span class="n">m</span><span class="p">):</span>
            <span class="k">break</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">amt</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">continue</span>

        <span class="k">if</span> <span class="n">limitMethods</span> <span class="ow">and</span> <span class="n">methods</span> <span class="o">&lt;=</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">m</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">nHasSet0</span><span class="p">:</span>
            <span class="k">break</span>
    
        <span class="c"># step#2</span>
        <span class="n">nHasSet2</span> <span class="o">=</span> <span class="n">m</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">amt</span> <span class="o">=</span> <span class="n">CheckObvious</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&quot;By Method#2, Try#{1}, we set {0} positions!&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">nHasSet2</span><span class="p">,</span> <span class="n">nTry</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">isDone</span><span class="p">(</span><span class="n">m</span><span class="p">):</span>
            <span class="k">break</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">amt</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">continue</span>
            
        <span class="k">if</span> <span class="n">limitMethods</span> <span class="ow">and</span> <span class="n">methods</span> <span class="o">&lt;=</span> <span class="mi">2</span> <span class="ow">and</span> <span class="n">m</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">nHasSet0</span><span class="p">:</span>
            <span class="k">break</span>
        

        <span class="c"># step#3, Reduce number by the Box Group number, and set it if it only one possible number left</span>
        <span class="n">nHasSet3</span> <span class="o">=</span> <span class="n">m</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">CheckInObvious</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>
        <span class="n">amt</span> <span class="o">=</span> <span class="n">m</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">nHasSet3</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&quot;By Method#3, Try#{1}, we set set {0} positions!&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">amt</span><span class="p">,</span> <span class="n">nTry</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">isDone</span><span class="p">(</span><span class="n">m</span><span class="p">):</span>
            <span class="k">break</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">amt</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">continue</span>
        <span class="k">if</span> <span class="n">limitMethods</span> <span class="ow">and</span> <span class="n">methods</span> <span class="o">&lt;=</span> <span class="mi">3</span> <span class="ow">and</span> <span class="n">m</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">nHasSet0</span><span class="p">:</span>
            <span class="k">break</span>

        <span class="c"># step #4, check Only One Possible By Position</span>
        <span class="n">nHasSet4</span> <span class="o">=</span> <span class="n">m</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">amt</span> <span class="o">=</span> <span class="n">CheckOnlyOnePossibleByPos</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&quot;By Method#4, Try#{1}, we set {0} positions!&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">nHasSet4</span><span class="p">,</span> <span class="n">nTry</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">isDone</span><span class="p">(</span><span class="n">m</span><span class="p">):</span>
            <span class="k">break</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">amt</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">continue</span>
        <span class="k">if</span> <span class="n">limitMethods</span> <span class="ow">and</span> <span class="n">methods</span> <span class="o">&lt;=</span> <span class="mi">4</span> <span class="ow">and</span> <span class="n">m</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">nHasSet0</span><span class="p">:</span>
            <span class="k">break</span>

        <span class="c"># step #5, check Only One Possible</span>
        <span class="c"># assume here we have writen all possible number in unassgined position</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">HasWritenPossible</span><span class="p">:</span>
            <span class="n">HasWritenPossible</span> <span class="o">=</span> <span class="bp">True</span>
            <span class="k">print</span><span class="p">(</span><span class="s">&quot;Write down every possible number in every un-assigned possition!&quot;</span><span class="p">)</span>           
        <span class="n">nHasSet5</span> <span class="o">=</span> <span class="n">m</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">amt</span> <span class="o">=</span> <span class="n">CheckOnlyOnePossible</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&quot;By Method#5, Try#{1}, we set {0} positions!&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">nHasSet5</span><span class="p">,</span> <span class="n">nTry</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">isDone</span><span class="p">(</span><span class="n">m</span><span class="p">):</span>
            <span class="k">break</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">amt</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">continue</span>
        <span class="k">if</span> <span class="n">limitMethods</span> <span class="ow">and</span> <span class="n">methods</span> <span class="o">&lt;=</span> <span class="mi">5</span> <span class="ow">and</span> <span class="n">m</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">nHasSet0</span><span class="p">:</span>
            <span class="k">break</span>

        <span class="c"># step #6, reduce number by Box Group</span>
        <span class="n">nHasSet6</span> <span class="o">=</span> <span class="n">m</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">reduces</span><span class="p">,</span> <span class="n">sets</span> <span class="o">=</span> <span class="n">ReduceByBoxGroup</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&quot;By Reduce#6, Try#{1}, we reduce {0} times and set {2} positions!&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">reduces</span><span class="p">,</span> <span class="n">nTry</span><span class="p">,</span> <span class="n">sets</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">isDone</span><span class="p">(</span><span class="n">m</span><span class="p">):</span>
            <span class="k">break</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">reduces</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">sets</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">continue</span>
        <span class="k">if</span> <span class="n">limitMethods</span> <span class="ow">and</span> <span class="n">methods</span> <span class="o">&lt;=</span> <span class="mi">6</span> <span class="ow">and</span> <span class="n">m</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">nHasSet0</span><span class="p">:</span>
            <span class="k">break</span>

        <span class="c"># step #7, reduce number by Box Chain</span>
        <span class="n">nHasSet7</span> <span class="o">=</span> <span class="n">m</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">reduces</span><span class="p">,</span> <span class="n">sets</span> <span class="o">=</span> <span class="n">ReduceByBoxChain</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&quot;By Reduce#7, Try#{1}, we reduce {0} times and set {2} positions!&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">reduces</span><span class="p">,</span> <span class="n">nTry</span><span class="p">,</span> <span class="n">sets</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">isDone</span><span class="p">(</span><span class="n">m</span><span class="p">):</span>
            <span class="k">break</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">reduces</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">sets</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">continue</span>
        <span class="k">if</span> <span class="n">limitMethods</span> <span class="ow">and</span> <span class="n">methods</span> <span class="o">&lt;=</span> <span class="mi">7</span> <span class="ow">and</span> <span class="n">m</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">nHasSet0</span><span class="p">:</span>
            <span class="k">break</span>

        <span class="c"># step #8, reduce number by X Line Chain </span>
        <span class="n">nHasSet8</span> <span class="o">=</span> <span class="n">m</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">reduces</span><span class="p">,</span> <span class="n">sets</span> <span class="o">=</span> <span class="n">ReduceByLineChain</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">direction</span><span class="o">=</span><span class="s">&quot;x&quot;</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&quot;By Reduce#8, Try#{1}, we reduce {0} times and set {2} positions!&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">reduces</span><span class="p">,</span> <span class="n">nTry</span><span class="p">,</span> <span class="n">sets</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">isDone</span><span class="p">(</span><span class="n">m</span><span class="p">):</span>
            <span class="k">break</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">reduces</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">sets</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">continue</span>
        <span class="k">if</span> <span class="n">limitMethods</span> <span class="ow">and</span> <span class="n">methods</span> <span class="o">&lt;=</span> <span class="mi">8</span> <span class="ow">and</span> <span class="n">m</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">nHasSet0</span><span class="p">:</span>
            <span class="k">break</span>

        <span class="c"># step #9, reduce number by Y Line Chain</span>
        <span class="n">nHasSet9</span> <span class="o">=</span> <span class="n">m</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">reduces</span><span class="p">,</span> <span class="n">sets</span> <span class="o">=</span> <span class="n">ReduceByLineChain</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">direction</span><span class="o">=</span><span class="s">&quot;y&quot;</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&quot;By Reduce#9, Try#{1}, we reduce {0} times and set {2} positions!&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">reduces</span><span class="p">,</span> <span class="n">nTry</span><span class="p">,</span> <span class="n">sets</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">isDone</span><span class="p">(</span><span class="n">m</span><span class="p">):</span>
            <span class="k">break</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">reduces</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">sets</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">continue</span>
        <span class="k">if</span> <span class="n">limitMethods</span> <span class="ow">and</span> <span class="n">methods</span> <span class="o">&lt;=</span> <span class="mi">9</span> <span class="ow">and</span> <span class="n">m</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">nHasSet0</span><span class="p">:</span>
            <span class="k">break</span>

        <span class="c"># step#10, reduce number by having Two Possible number&#39;s postions</span>
        <span class="n">nHasSet10</span> <span class="o">=</span> <span class="n">m</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">reduces</span><span class="p">,</span> <span class="n">sets</span> <span class="o">=</span> <span class="n">ReduceByTwoPossible</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&quot;By Reduce#10, Try#{1}, we reduce {0} times and set {2} positions!&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">reduces</span><span class="p">,</span> <span class="n">nTry</span><span class="p">,</span> <span class="n">sets</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">isDone</span><span class="p">(</span><span class="n">m</span><span class="p">):</span>
            <span class="k">break</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">reduces</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">sets</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">continue</span>
        <span class="k">if</span> <span class="n">limitMethods</span> <span class="ow">and</span> <span class="n">methods</span> <span class="o">&lt;=</span> <span class="mi">10</span> <span class="ow">and</span> <span class="n">m</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">nHasSet0</span><span class="p">:</span>
            <span class="k">break</span>

        <span class="c"># step#11, reduce number by only two possible positons in the same box which have the common possible value </span>
        <span class="n">nHasSet11</span> <span class="o">=</span> <span class="n">m</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">reduces</span><span class="p">,</span> <span class="n">sets</span> <span class="o">=</span> <span class="n">ReduceByTwoPositionInBox</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&quot;By Reduce#11, Try#{1}, we reduce {0} times and set {2} positions!&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">reduces</span><span class="p">,</span> <span class="n">nTry</span><span class="p">,</span> <span class="n">sets</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">isDone</span><span class="p">(</span><span class="n">m</span><span class="p">):</span>
            <span class="k">break</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">reduces</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">sets</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">continue</span>
        <span class="k">if</span> <span class="n">limitMethods</span> <span class="ow">and</span> <span class="n">methods</span> <span class="o">&lt;=</span> <span class="mi">11</span> <span class="ow">and</span> <span class="n">m</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">nHasSet0</span><span class="p">:</span>
            <span class="k">break</span>

        <span class="c"># step#12, reduce number by only two possible positions in the same x line which have the common possible value</span>
        <span class="n">nHasSet12</span> <span class="o">=</span> <span class="n">m</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">reduces</span><span class="p">,</span> <span class="n">sets</span> <span class="o">=</span> <span class="n">ReduceByTwoPositionOfLine</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">direction</span><span class="o">=</span><span class="s">&quot;x&quot;</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&quot;By Reduce#12, Try#{1}, we reduce {0} times and set {2} positions!&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">reduces</span><span class="p">,</span> <span class="n">nTry</span><span class="p">,</span> <span class="n">sets</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">isDone</span><span class="p">(</span><span class="n">m</span><span class="p">):</span>
            <span class="k">break</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">reduces</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">sets</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">continue</span>
        <span class="k">if</span> <span class="n">limitMethods</span> <span class="ow">and</span> <span class="n">methods</span> <span class="o">&lt;=</span> <span class="mi">12</span> <span class="ow">and</span> <span class="n">m</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">nHasSet0</span><span class="p">:</span>
            <span class="k">break</span>

        <span class="c"># step#13, reduce number by only two possible positons in the same x line which have the common possible value </span>
        <span class="n">nHasSet13</span> <span class="o">=</span> <span class="n">m</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">reduces</span><span class="p">,</span> <span class="n">sets</span> <span class="o">=</span> <span class="n">ReduceByTwoPositionOfLine</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">direction</span><span class="o">=</span><span class="s">&quot;y&quot;</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&quot;By Reduce#13, Try#{1}, we reduce {0} times and set {2} positions!&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">reduces</span><span class="p">,</span> <span class="n">nTry</span><span class="p">,</span> <span class="n">sets</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">isDone</span><span class="p">(</span><span class="n">m</span><span class="p">):</span>
            <span class="k">break</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">reduces</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">sets</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">continue</span>
        <span class="k">if</span> <span class="n">limitMethods</span> <span class="ow">and</span> <span class="n">methods</span> <span class="o">&lt;=</span> <span class="mi">13</span> <span class="ow">and</span> <span class="n">m</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">nHasSet0</span><span class="p">:</span>
            <span class="k">break</span>

        <span class="c"># Can&#39;t solve position any more</span>
        <span class="k">if</span> <span class="n">m</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">nHasSet0</span><span class="p">:</span>
            <span class="k">break</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">continue</span>
       
    <span class="k">if</span> <span class="ow">not</span> <span class="n">isDone</span><span class="p">(</span><span class="n">m</span><span class="p">):</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&quot;Still need to more effort for {0}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="mi">81</span> <span class="o">-</span> <span class="n">m</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]))</span>
        <span class="n">printMatrix</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">p</span>

    <span class="k">print</span><span class="p">(</span><span class="s">&quot;Done!, it takes {0}!&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span><span class="p">))</span>
    <span class="n">printMatrix</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">p</span>
        
        
        
        
</pre></div></div>

          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li><a href="../../index.html">SudokuStudyLib 0.5 documentation</a> &raquo;</li>
          <li><a href="../index.html" >Module code</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2014, Robert J. Hwang.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2.2.
    </div>
  </body>
</html>